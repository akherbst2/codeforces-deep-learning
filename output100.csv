contest,input_specification,letter,main_text,memory_limit,output_specification,tags,time_limit,title
1,The input contains three positive integer numbers in the first line n m and a 1 n m a 109,A,Theatre Square in the capital city of Berland has a rectangular shape with the size n m meters On the occasion of the city s anniversary a decision was taken to pave the Square with square granite flagstones Each flagstone is of the size a a What is the least number of flagstones needed to pave the Square It s allowed to cover the surface larger than the Theatre Square but the Square has to be covered It s not allowed to break the flagstones The sides of flagstones should be parallel to the sides of the Square,256 megabytes,Write the needed number of flagstones,['math'],1 second,A Theatre Square
1,The first line of the input contains integer number n 1 n 105 the number of coordinates in the test Then there follow n lines each of them contains coordinates All the coordinates are correct there are no cells with the column and or the row numbers larger than 106,B,In the popular spreadsheets systems for example in Excel the following numeration of columns is used The first column has number A the second number B etc till column 26 that is marked by Z Then there are two-letter numbers column 27 has number AA 28 AB column 52 is marked by AZ After ZZ there follow three-letter numbers etc The rows are marked by integer numbers starting with 1 The cell name is the concatenation of the column and the row numbers For example BC23 is the name for the cell that is in column 55 row 23 Sometimes another numeration system is used RXCY where X and Y are integer numbers showing the column and the row numbers respectfully For instance R23C55 is the cell from the previous example Your task is to write a program that reads the given sequence of cell coordinates and produce each item written according to the rules of another numeration system,64 megabytes,Write n lines each line should contain a cell coordinates in the other numeration system,['implementation'/ 'math'],10 seconds,B Spreadsheets
1,The input file consists of three lines each of them contains a pair of numbers coordinates of the pillar Any coordinate doesn t exceed 1000 by absolute value and is given with at most six digits after decimal point,C,Nowadays all circuses in Berland have a round arena with diameter 13 meters but in the past things were different In Ancient Berland arenas in circuses were shaped as a regular equiangular polygon the size and the number of angles could vary from one circus to another In each corner of the arena there was a special pillar and the rope strung between the pillars marked the arena edges Recently the scientists from Berland have discovered the remains of the ancient circus arena They found only three pillars the others were destroyed by the time You are given the coordinates of these three pillars Find out what is the smallest area that the arena could have,64 megabytes,Output the smallest possible area of the ancient arena This number should be accurate to at least 6 digits after the decimal point It s guaranteed that the number of angles in the optimal polygon is not larger than 100,['geometry'/ 'math'],2 seconds,C Ancient Berland Circus
10,The first line contains 6 integer numbers n P1 P2 P3 T1 T2 1 n 100 0 P1 P2 P3 100 1 T1 T2 60 The following n lines contain description of Tom s work Each i-th of these lines contains two space-separated integers li and ri 0 li ri 1440 ri li 1 for i n which stand for the start and the end of the i-th period of work,A,Tom is interested in power consumption of his favourite laptop His laptop has three modes In normal mode laptop consumes P1 watt per minute T1 minutes after Tom moved the mouse or touched the keyboard for the last time a screensaver starts and power consumption changes to P2 watt per minute Finally after T2 minutes from the start of the screensaver laptop switches to the sleep mode and consumes P3 watt per minute If Tom moves the mouse or touches the keyboard when the laptop is in the second or in the third mode it switches to the first normal mode Tom s work with the laptop can be divided into n time periods l1 r1 l2 r2 ln rn During each interval Tom continuously moves the mouse and presses buttons on the keyboard Between the periods Tom stays away from the laptop Find out the total amount of power consumed by the laptop during the period l1 rn,256 megabytes,Output the answer to the problem,['implementation'],1 second,A Power Consumption Calculation
10,The first line contains two integers N and K 1 N 1000 1 K 99 the amount of requests and the hall size respectively The second line contains N space-separated integers Mi from the range 1 K requests to the program,B,All cinema halls in Berland are rectangles with K rows of K seats each and K is an odd number Rows and seats are numbered from 1 to K For safety reasons people who come to the box office to buy tickets are not allowed to choose seats themselves Formerly the choice was made by a cashier but now this is the responsibility of a special seating program It was found out that the large majority of Berland s inhabitants go to the cinema in order to watch a movie that s why they want to sit as close to the hall center as possible Moreover a company of M people who come to watch a movie want necessarily to occupy M successive seats in one row Let s formulate the algorithm according to which the program chooses seats and sells tickets As the request for M seats comes the program should determine the row number x and the segment yl yr of the seats numbers in this row where yr - yl 1 M From all such possible variants as a final result the program should choose the one with the minimum function value of total seats remoteness from the center Say the row and the seat numbers of the most central seat Then the function value of seats remoteness from the hall center is If the amount of minimum function values is more than one the program should choose the one that is closer to the screen i e the row number x is lower If the variants are still multiple it should choose the one with the minimum yl If you did not get yet your task is to simulate the work of this program,256 megabytes,Output N lines In the i-th line output -1 without quotes if it is impossible to find Mi successive seats in one row otherwise output three numbers x yl yr Separate the numbers with a space,['dp'/ 'implementation'],1 second,B Cinema Cashier
10,The first line contains the only number N 1 N 106,C,Not long ago Billy came across such a problem where there were given three natural numbers A B and C from the range 1 N and it was asked to check whether the equation AB C is correct Recently Billy studied the concept of a digital root of a number We should remind you that a digital root d x of the number x is the sum s x of all the digits of this number if s x 9 otherwise it is d s x For example a digital root of the number 6543 is calculated as follows d 6543 d 6 5 4 3 d 18 9 Billy has counted that the digital root of a product of numbers is equal to the digital root of the product of the factors digital roots i e d xy d d x d y And the following solution to the problem came to his mind to calculate the digital roots and check if this condition is met However Billy has doubts that this condition is sufficient That s why he asks you to find out the amount of test examples for the given problem such that the algorithm proposed by Billy makes mistakes,256 megabytes,Output one number the amount of required A B and C from the range 1 N,['number theory'],2 seconds,C Digital Root
10,The first line contains an integer n 1 n 500 the length of the first sequence The second line contains n space-separated integers from the range 0 109 elements of the first sequence The third line contains an integer m 1 m 500 the length of the second sequence The fourth line contains m space-separated integers from the range 0 109 elements of the second sequence,D,This problem differs from one which was on the online contest The sequence a1 a2 an is called increasing if ai ai 1 for i n The sequence s1 s2 sk is called the subsequence of the sequence a1 a2 an if there exist such a set of indexes 1 i1 i2 ik n that aij sj In other words the sequence s can be derived from the sequence a by crossing out some elements You are given two sequences of integer numbers You are to find their longest common increasing subsequence i e an increasing sequence of maximum length that is the subsequence of both sequences,256 megabytes,In the first line output k the length of the longest common increasing subsequence In the second line output the subsequence itself Separate the elements with a space If there are several solutions output any,['dp'],1 second,D LCIS
10,The first line contains an integer n 1 n 400 the amount of the coins face values The second line contains n integers ai 1 ai 109 describing the face values It is guaranteed that a1 a2 an and an 1,E,Billy investigates the question of applying greedy algorithm to different spheres of life At the moment he is studying the application of greedy algorithm to the problem about change There is an amount of n coins of different face values and the coins of each value are not limited in number The task is to collect the sum x with the minimum amount of coins Greedy algorithm with each its step takes the coin of the highest face value not exceeding x Obviously if among the coins face values exists the face value 1 any sum x can be collected with the help of greedy algorithm However greedy algorithm does not always give the optimal representation of the sum i e the representation with the minimum amount of coins For example if there are face values 1 3 4 and it is asked to collect the sum 6 greedy algorithm will represent the sum as 4 1 1 while the optimal representation is 3 3 containing one coin less By the given set of face values find out if there exist such a sum x that greedy algorithm will collect in a non-optimal way If such a sum exists find out the smallest of these sums,256 megabytes,If greedy algorithm collects any sum in an optimal way output -1 Otherwise output the smallest sum that greedy algorithm collects in a non-optimal way,['constructive algorithms'],2 seconds,E Greedy Change
100,The input consists of three integer numbers n k and n1 10 n 12 1 k 10,A,Soroush s room is a square with side length n Before this contest he bought k fine Persian carpets to carpet his room for celebrating the 100th contest on his favorite site Each Persian carpet is a square of side length n1 Soroush wants to cover all the area of his room Carpets can be put over each other but it is not allowed to rotate the carpets Can Soroush carpet his room completely,64 megabytes,Write a single YES or NO Write YES if and only if Sorush can carpet his room completely,['special problem'/ 'implementation'],2 seconds,A Carpeting the Room
100,The first line contains n 1 n 1000 where n the number of integers in the group The next line contains the elements sorted in the non-decreasing order The numbers are comma separated they have at most 7 digits in their decimal notation and do not have any leading zeros,B,Kiana thinks two integers are friends if and only if one of them divides the other one For example 12 and 4 are friends also 6 and 6 are friends too but 120 and 36 are not A group of non-zero integers is called friendly if each pair of its integers form a friend pair You are given a group of non-zero integers See if they re friendly,256 megabytes,If the group is friendly write FRIENDS else write NOT FRIENDS,['special problem'/ 'implementation'],2 seconds,B Friendly Numbers
100,You are given two integers a and b one per line 1 a b 10500 These numbers will not have any leading zeros,C,Bijan is new to programming He learned recently that programmers do not code every bit of their apps from scratch For example they never write a code to sum two integers because their languages have the ability to do the sum But can they use it Can an experienced coder who has attended more than 100 contests sum two integers Bijan is not sure about this What s your opinion,64 megabytes,Write sum of the two integers Do not put any leading zeros,['special problem'/ 'implementation'],2 seconds,C A B
100,The first line contains a single integer n 2 n 8 106 the number of Aida s friends The following two lines contain a non-empty string each initial and final strings The lengths of strings are at most 107 and they only contain English alphabet letters,D,There are a lot of rumors in the media these days One day Aida decided to find out how rumors are made She asked n of her friends to help her They all formed a circle and Aida told the person to her right a piece of news which was just a simple string Then each person told the string to the person on his her right But they didn t tell the string exactly as they d heard it Each person made at most one of these two types of changes Removing one character from the end of the heard string Adding a character to the end of the heard string Finally when the rumor passed exactly n moves a complete cycle Aida heard something quite different from what she expected from the person on her left She thinks someone has cheated and made some changes other than those explained above Now she wants you to write a Pike piece of code which gets the initial and final strings and tells Aida whether it s possible to get to the final string from the initial one by the rules described above,256 megabytes,Write a single YES or NO Write YES only if it s possible to get to the final string from the initial string,['special problem'/ 'strings'],5 seconds,D World of Mouth
100,The first line of input contains a single integer n the number of lamps 1 n 105 The following line contains n words The i-th word describes the initial state of lamp number i see samples for details The following line contains a single integer k 1 k 104 the number of times a key is pressed Then in the next line come k integers in range 1 n which are the numbers of the pressed keys,E,There are n lamps in a line The lamps are numbered 1 to n from left to right There are also n keys When key number i is pressed all lamps number x such that i x change their state For two integer numbers a and b we say a b if and only if there exists an integer c such that a c b Amirali likes to play with the keys He randomly pressed k keys and wants to know the final state of the lamps Help him by writing a Pike piece of code to solve this task,256 megabytes,Write n words to output Describe the final state of the lamps See samples for more details,['special problem'/ 'math'],1 second,E Lamps in a Line
100,The first line of the input contains n 1 n 9 The following n lines contain integer ai - 10 ai 10,F,You are given a polynom in form p x x a1 x a2 x an Write Pike program to print it in a standard form p x xn b1xn - 1 bn - 1x bn You should write each addend in form C X K for example 5 X 8 Please write the polynom in the shortest way so you should skip unnecessary terms some terms C X K should be reduced or even omitted Look for the samples for clarification,64 megabytes,Print the given polynom in a standard way Note that the answer in this problem response uniquely determined,['special problem'/ 'implementation'],2 seconds,F Polynom
100,The first line contains a single integer n 0 n 105 the number of used names The following n lines each contain a string the album name and an integer the year album was published Album names are made of lowercase Latin letters and contain at most 14 letters The year is in range 1900 2011 The following line contains a single integer m 1 m 104 the number of suitable album names The following m lines each contain a string a suitable name It contains at most 14 lowercase Latin letters All album names and suitable names are non-empty,G,The famous singer Aryo is going to publish a new album of his great work Unfortunately these days there are many albums Aryo wants to choose a new name for his album a name that has not been used or at least has not been used recently He has a list of all used album names together with the year the albums were published He also has a list of suitable names for his album If he finds a suitable name which has not been used before he ll use it Otherwise he will use the name which was used as long ago as possible If two such names are found that haven t been used or were used at the same year he uses the name that is alphabetically latest Help him name his album,64 megabytes,Write a single string The name of the new album,['special problem'/ 'data structures'/ 'implementation'],2 seconds,G Name the album
100,The first line contains number n 1 n 10 the number of boards Each board is described by 10 lines containing 10 characters each The symbol 0 stands for an empty square and the symbol stands for a square occupied by a ship The descriptions of boards are separated with empty lines,H,Do you know the game Battleship If no look into Wikipedia article http en wikipedia org wiki Battleship game You are given the positions of ships on a 10 10 board for playing Battleship According to the rules the board should contain the following ships one of size 4 4 1 or 1 4 rectangle two of size 3 3 1 or 1 3 rectangles three of size 2 2 1 or 1 2 rectangles four of size 1 1 1 rectangles The ships should not bend touch each other or overlap in any way Each ship can be oriented horizontaly or verticaly Your task is to check whether the given set of boards meets the given conditions,64 megabytes,Print n lines YES or NO Print the first word if the board meets the given conditions otherwise print the second word,['special problem'/ 'dfs and similar'/ 'implementation'],2 seconds,H Battleship
100,A single integer k 0 k 360 is given in the first line Two integer numbers x and y are given in the second line - 1390 x y 1390,I,Ehsan loves geometry Especially he likes to rotate points Given a point in the plane Ehsan likes to rotate it by k degrees counter-clockwise around the origin What is the result of this rotation,64 megabytes,Write two numbers The result of the rotation Your answer must have a relative error less than 10 - 1,['special problem'/ 'geometry'/ 'math'],2 seconds,I Rotation
100,The first line contains a single integer n 1 n 103 number of intervals The following n lines contain a interval description each Each interval is described by two numbers si ei which are the start and end points of it - 105 si ei 105 si ei See samples for clarity A square bracket stands for including of the corresponding endpoint while a round bracket stands for excluding,J,Aryo has got a lot of intervals for his 2418th birthday He is really excited and decided to color all these intervals with some colors He has a simple rule for himself He calls a coloring nice if there exists no three intervals a b and c such that the following conditions are satisfied simultaneously a b and c are colored with the same color Moreover he found out that for every intervals i and j there is at least one point in i which isn t in j Given some set of intervals You have to find the minimum number k such that Aryo can find a nice coloring with k colors,256 megabytes,Write a single integer k the minimum number of colors needed for a nice coloring,['special problem'/ 'greedy'/ 'math'],2 seconds,J Interval Coloring
101,The first input data line contains a string whose length is equal to n 1 n 105 The string consists of lowercase Latin letters The second line contains the number k 0 k 105,A,Once when Gerald studied in the first year at school his teacher gave the class the following homework She offered the students a string consisting of n small Latin letters the task was to learn the way the letters that the string contains are written However as Gerald is too lazy he has no desire whatsoever to learn those letters That s why he decided to lose some part of the string not necessarily a connected part The lost part can consist of any number of segments of any length at any distance from each other However Gerald knows that if he loses more than k characters it will be very suspicious Find the least number of distinct characters that can remain in the string after no more than k characters are deleted You also have to find any possible way to delete the characters,256 megabytes,Print on the first line the only number m the least possible number of different characters that could remain in the given string after it loses no more than k characters Print on the second line the string that Gerald can get after some characters are lost The string should have exactly m distinct characters The final string should be the subsequence of the initial string If Gerald can get several different strings with exactly m distinct characters print any of them,['greedy'],2 seconds,A Homework
101,The first line contains two space-separated integers n and m 1 n 109 0 m 105 Then follow m lines each containing two integers si ti They are the numbers of starting stops and end stops of the buses 0 si ti n,B,Little boy Gerald studies at school which is quite far from his house That s why he has to go there by bus every day The way from home to school is represented by a segment of a straight line the segment contains exactly n 1 bus stops All of them are numbered with integers from 0 to n in the order in which they follow from Gerald s home The bus stop by Gerald s home has number 0 and the bus stop by the school has number n There are m buses running between the house and the school the i-th bus goes from stop si to ti si ti visiting all the intermediate stops in the order in which they follow on the segment Besides Gerald s no idiot and he wouldn t get off the bus until it is still possible to ride on it closer to the school obviously getting off would be completely pointless In other words Gerald can get on the i-th bus on any stop numbered from si to ti - 1 inclusive but he can get off the i-th bus only on the bus stop ti Gerald can t walk between the bus stops and he also can t move in the direction from the school to the house Gerald wants to know how many ways he has to get from home to school Tell him this number Two ways are considered different if Gerald crosses some segment between the stops on different buses As the number of ways can be too much find the remainder of a division of this number by 1000000007 109 7,265 megabytes,Print the only number the number of ways to get to the school modulo 1000000007 109 7,['binary search'/ 'data structures'/ 'dp'],2 seconds,B Buses
101,The first line contains integers x1 y1 the coordinates of the vector A - 108 x1 y1 108 The second and the third line contain in the similar manner vectors B and C their coordinates are integers their absolute value does not exceed 108,C,At a geometry lesson Gerald was given a task to get vector B out of vector A Besides the teacher permitted him to perform the following operations with vector Turn the vector by 90 degrees clockwise Add to the vector a certain vector C Operations could be performed in any order any number of times Can Gerald cope with the task,256 megabytes,Print YES without the quotes if it is possible to get vector B using the given operations Otherwise print NO without the quotes,['implementation'/ 'math'],1 second,C Vectors
101,The first line contains the only integer n 2 n 105 the number of halls in the castle Next n - 1 lines each contain three integers The i-th line contains numbers ai bi and ti 1 ai bi n ai bi 1 ti 1000 the numbers of halls connected with the i-th corridor and the time needed to go along the corridor Initially Gerald is in the hall number 1 It is guaranteed that one can get from any hall to any other one using corridors,D,Gerald is positioned in an old castle which consists of n halls connected with n - 1 corridors It is exactly one way to go from any hall to any other one Thus the graph is a tree Initially at the moment of time 0 Gerald is positioned in hall 1 Besides some other hall of the castle contains the treasure Gerald is looking for The treasure s position is not known it can equiprobably be in any of other n - 1 halls Gerald can only find out where the treasure is when he enters the hall with the treasure That very moment Gerald sees the treasure and the moment is regarded is the moment of achieving his goal The corridors have different lengths At that the corridors are considered long and the halls are considered small and well lit Thus it is possible not to take the time Gerald spends in the halls into consideration The castle is very old that s why a corridor collapses at the moment when somebody visits it two times no matter in which direction Gerald can move around the castle using the corridors he will go until he finds the treasure Naturally Gerald wants to find it as quickly as possible In other words he wants to act in a manner that would make the average time of finding the treasure as small as possible Each corridor can be used no more than two times That s why Gerald chooses the strategy in such a way so he can visit every hall for sure More formally if the treasure is located in the second hall then Gerald will find it the moment he enters the second hall for the first time let it be moment t2 If the treasure is in the third hall then Gerald will find it the moment he enters the third hall for the first time Let it be the moment of time t3 And so on Thus the average time of finding the treasure will be equal to,256 megabytes,Print the only real number the sought expectation of time needed to find the treasure The answer should differ from the right one in no less than 10 - 6,['dp'/ 'greedy'/ 'probabilities'/ 'sortings'/ 'trees'],2 seconds,D Castle
101,The first line contains three integers n m p 1 n m 20000 1 p 109 The second line contains n integers x0 x1 xn - 1 0 xi 20000 The third line contains m integers y0 y1 ym - 1 0 yi 20000 The value of f a b is calculated as a remainder of the division of the sum xa yb by number p,E,Little Gerald and his coach Mike play an interesting game At the beginning of the game there is a pile consisting of n candies and a pile consisting of m stones Gerald and Mike move in turns Mike goes first During his move Mike checks how many candies and stones Gerald has eaten Let Gerald eat a candies and b stones Then Mike awards Gerald f a b prize points Gerald during his move either eats a candy from the pile of candies or a stone from the pile of stones As Mike sees that Gerald has eaten everything apart one candy and one stone he awards points for the last time and the game ends Gerald is not allowed to eat all the candies and he is not allowed to eat all the stones too Tell Gerald how to play to get the largest possible number of points it is required to find one of the possible optimal playing strategies for Gerald,45 megabytes,Print on the first line the only number the maximal number of points Gerald can earn Print on the second line a sting consisting of n m - 2 characters each of which is either a C or S the i-th character should be C if Gerald s i-th move should be eating a candy and S if he should eat a stone,['divide and conquer'/ 'dp'],7 5 seconds,E Candies and Stones
102,The first input file line contains integers n and m the total number of clothing items in the shop and the total number of matching pairs of clothing items Next line contains n integers ai 1 ai 106 the prices of the clothing items in rubles Next m lines each contain a pair of space-separated integers ui and vi 1 ui vi n ui vi Each such pair of numbers means that the ui-th and the vi-th clothing items match each other It is guaranteed that in each pair ui and vi are distinct and all the unordered pairs ui vi are different,A,A little boy Gerald entered a clothes shop and found out something very unpleasant not all clothes turns out to match For example Gerald noticed that he looks rather ridiculous in a smoking suit and a baseball cap Overall the shop sells n clothing items and exactly m pairs of clothing items match Each item has its price represented by an integer number of rubles Gerald wants to buy three clothing items so that they matched each other Besides he wants to spend as little money as possible Find the least possible sum he can spend,256 megabytes,Print the only number the least possible sum in rubles that Gerald will have to pay in the shop If the shop has no three clothing items that would match each other print -1 without the quotes,['brute force'],2 seconds,A Clothes
102,The first line contains the only integer n 0 n 10100000 It is guaranteed that n doesn t contain any leading zeroes,B,Having watched the last Harry Potter film little Gerald also decided to practice magic He found in his father s magical book a spell that turns any number in the sum of its digits At the moment Gerald learned that he came across a number n How many times can Gerald put a spell on it until the number becomes one-digit,265 megabytes,Print the number of times a number can be replaced by the sum of its digits until it only contains one digit,['implementation'],2 seconds,B Sum of Digits
103,The first line contains a positive integer n 1 n 100 It is the number of questions in the test The second line contains space-separated n positive integers ai 1 ai 109 the number of answer variants to question i,A,The average miner Vaganych took refresher courses As soon as a miner completes the courses he should take exams The hardest one is a computer test called Testing Pants for Sadness The test consists of n questions the questions are to be answered strictly in the order in which they are given from question 1 to question n Question i contains ai answer variants exactly one of them is correct A click is regarded as selecting any answer in any question The goal is to select the correct answer for each of the n questions If Vaganych selects a wrong answer for some question then all selected answers become unselected and the test starts from the very beginning from question 1 again But Vaganych remembers everything The order of answers for each question and the order of questions remain unchanged as well as the question and answers themselves Vaganych is very smart and his memory is superb yet he is unbelievably unlucky and knows nothing whatsoever about the test s theme How many clicks will he have to perform in the worst case,256 megabytes,Print a single number the minimal number of clicks needed to pass the test it the worst-case scenario Please do not use the lld specificator to read or write 64-bit integers in It is preferred to use the cin cout streams or the I64d specificator,['greedy'/ 'implementation'/ 'math'],2 seconds,A Testing Pants for Sadness
103,The first line contains two integers the number of vertices n and the number of edges m of the graph 1 n 100 0 m Each of the following m lines contains a pair of integers x and y that show that an edge exists between vertices x and y 1 x y n x y For each pair of vertices there will be at most one edge between them no edge connects a vertex to itself,B,Once upon a time a man came to the sea The sea was stormy and dark The man started to call for the little mermaid to appear but alas he only woke up Cthulhu Whereas on the other end of the world Pentagon is actively collecting information trying to predict the monster s behavior and preparing the secret super weapon Due to high seismic activity and poor weather conditions the satellites haven t yet been able to make clear shots of the monster The analysis of the first shot resulted in an undirected graph with n vertices and m edges Now the world s best minds are about to determine whether this graph can be regarded as Cthulhu or not To add simplicity let s suppose that Cthulhu looks from the space like some spherical body with tentacles attached to it Formally we shall regard as Cthulhu such an undirected graph that can be represented as a set of three or more rooted trees whose roots are connected by a simple cycle It is guaranteed that the graph contains no multiple edges and self-loops,256 megabytes,Print NO if the graph is not Cthulhu and FHTAGN if it is,['dfs and similar'/ 'dsu'/ 'graphs'],2 seconds,B Cthulhu
103,The first line contains three integers n k and p 1 n 1018 0 k n 1 p 1000 the number of slots in the cylinder the number of bullets and the number of queries Then follow p lines they are the queries Each line contains one integer xi 1 xi n the number of slot to describe Please do not use the lld specificator to read or write 64-bit numbers in It is preferred to use cin cout streams or the I64d specificator,C,After all the events in Orlando we all know Sasha and Roma decided to find out who is still the team s biggest loser Thankfully Masha found somewhere a revolver with a rotating cylinder of n bullet slots able to contain exactly k bullets now the boys have a chance to resolve the problem once and for all Sasha selects any k out of n slots he wishes and puts bullets there Roma spins the cylinder so that every of n possible cylinder s shifts is equiprobable Then the game starts the players take turns Sasha starts he puts the gun to his head and shoots If there was no bullet in front of the trigger the cylinder shifts by one position and the weapon is given to Roma for make the same move The game continues until someone is shot the survivor is the winner Sasha does not want to lose so he must choose slots for bullets in such a way as to minimize the probability of its own loss Of all the possible variant he wants to select the lexicographically minimal one where an empty slot is lexicographically less than a charged one More formally the cylinder of n bullet slots able to contain k bullets can be represented as a string of n characters Exactly k of them are X charged slots and the others are uncharged slots Let us describe the process of a shot Suppose that the trigger is in front of the first character of the string the first slot If a shot doesn t kill anyone and the cylinder shifts then the string shifts left So the first character becomes the last one the second character becomes the first one and so on But the trigger doesn t move It will be in front of the first character of the resulting string Among all the strings that give the minimal probability of loss Sasha choose the lexicographically minimal one According to this very string he charges the gun You have to help Sasha to charge the gun For that each xi query must be answered is there a bullet in the positions xi,256 megabytes,For each query print if the slot should be empty and X if the slot should be charged,['constructive algorithms'/ 'greedy'],2 seconds,C Russian Roulette
103,The first line contains the only positive integer n 1 n 3 105 the number of cows in the cowavan The second number contains n positive integer wi separated by spaces where the i-th number describes the mass of the i-th cow in the cowavan 1 wi 109 The third line contains the only positive integer p the number of scenarios of a b -raids 1 p 3 105 Each following line contains integer parameters a and b of the corresponding scenario 1 a b n,D,As you know the most intelligent beings on the Earth are of course cows This conclusion was reached long ago by the Martian aliens as well as a number of other intelligent civilizations from outer space Sometimes cows gather into cowavans This seems to be seasonal But at this time the cows become passive and react poorly to external stimuli A cowavan is a perfect target for the Martian scientific saucer it s time for large-scale abductions or as the Martians say raids Simply put a cowavan is a set of cows in a row If we number all cows in the cowavan with positive integers from 1 to n then we can formalize the popular model of abduction known as the a b -Cowavan Raid first they steal a cow number a then number a b then number a 2 b and so on until the number of an abducted cow exceeds n During one raid the cows are not renumbered The aliens would be happy to place all the cows on board of their hospitable ship but unfortunately the amount of cargo space is very very limited The researchers knowing the mass of each cow in the cowavan made p scenarios of the a b -raid Now they want to identify the following thing for each scenario individually what total mass of pure beef will get on board of the ship All the scenarios are independent in the process of performing the calculations the cows are not being stolen,70 megabytes,Print for each scenario of the a b -raid the total mass of cows that can be stolen using only this scenario Please do not use the lld specificator to read or write 64-bit integers in It is recommended to use the cin cout streams of the I64d specificator,['brute force'/ 'data structures'/ 'sortings'],4 seconds,D Time to Raid Cowavans
103,The first line contains the only number n 1 n 300 the number of sets available in the market Next n lines describe the goods first we are given mi 1 mi n the number of distinct numbers in the i-th set then follow mi numbers the set s elements We know that the set s elements are distinct positive integers and they do not exceed n The last line contains n integers whose absolute values do not exceed 106 the price of each set,E,The Hexadecimal virus loves playing with number sets intersecting them uniting them One beautiful day she was surprised to find out that Scuzzy her spherical pet cat united all sets in one and ate the result Something had to be done quickly and Hexadecimal rushed to the market The market has n sets of numbers on sale The virus wants to buy the following collection of sets the number of sets in the collection should be exactly the same as the number of numbers in the union of all bought sets Moreover Hexadecimal wants to buy the cheapest suitable collection of set Yet nothing s so easy As Mainframe is a kingdom of pure rivalry markets we know that the union of any k sets contains no less than k distinct numbers for every positive integer k Help the virus choose the suitable collection of sets The collection can be empty,256 megabytes,Print a single number the minimum price the virus will have to pay for such a collection of k sets that union of the collection s sets would have exactly k distinct numbers,['flows'/ 'graph matchings'],2 seconds,E Buying Sets
104,The only line contains n 1 n 25 the required sum of points,A,One rainy gloomy evening when all modules hid in the nearby cafes to drink hot energetic cocktails the Hexadecimal virus decided to fly over the Mainframe to look for a Great Idea And she has found one Why not make her own Codeforces with blackjack and other really cool stuff Many people will surely be willing to visit this splendid shrine of high culture In Mainframe a standard pack of 52 cards is used to play blackjack The pack contains cards of 13 values 2 3 4 5 6 7 8 9 10 jacks queens kings and aces Each value also exists in one of four suits hearts diamonds clubs and spades Also each card earns some value in points assigned to it cards with value from two to ten earn from 2 to 10 points correspondingly An ace can either earn 1 or 11 whatever the player wishes The picture cards king queen and jack earn 10 points The number of points a card earns does not depend on the suit The rules of the game are very simple The player gets two cards if the sum of points of those cards equals n then the player wins otherwise the player loses The player has already got the first card it s the queen of spades To evaluate chances for victory you should determine how many ways there are to get the second card so that the sum of points exactly equals n,256 megabytes,Print the numbers of ways to get the second card in the required way if the first card is the queen of spades,['implementation'],2 seconds,A Blackjack
105,The first line contains three numbers n m and k the number of skills the current character has the number of skills specific for the class into which the character is going to transmigrate and the reducing coefficient respectively n and m are integers and k is a real number with exactly two digits after decimal point 1 n m 20 0 01 k 0 99 Then follow n lines each of which describes a character s skill in the form name exp the skill s name and the character s skill level name is a string and exp is an integer in range from 0 to 9999 inclusive Then follow m lines each of which contains names of skills specific for the class into which the character transmigrates All names consist of lowercase Latin letters and their lengths can range from 1 to 20 characters inclusive All character s skills have distinct names Besides the skills specific for the class into which the player transmigrates also have distinct names,A,In Disgaea as in most role-playing games characters have skills that determine the character s ability to use certain weapons or spells If the character does not have the necessary skill he cannot use it The skill level is represented as an integer that increases when you use this skill Different character classes are characterized by different skills Unfortunately the skills that are uncommon for the given character s class are quite difficult to obtain To avoid this limitation there is the so-called transmigration Transmigration is reincarnation of the character in a new creature His soul shifts to a new body and retains part of his experience from the previous life As a result of transmigration the new character gets all the skills of the old character and the skill levels are reduced according to the k coefficient if the skill level was equal to x then after transmigration it becomes equal to kx where y is the integral part of y If some skill s levels are strictly less than 100 these skills are forgotten the character does not have them any more After that the new character also gains the skills that are specific for his class but are new to him The levels of those additional skills are set to 0 Thus one can create a character with skills specific for completely different character classes via transmigrations For example creating a mage archer or a thief warrior is possible You are suggested to solve the following problem what skills will the character have after transmigration and what will the levels of those skills be,256 megabytes,Print on the first line number z the number of skills the character will have after the transmigration Then print z lines on each of which print a skill s name and level separated by a single space The skills should be given in the lexicographical order,['implementation'],2 seconds,A Transmigration
105,The first line contains three integers n k and A 1 n k 8 1 A 9999 Then n lines follow The i-th of them contains two numbers bi and li the i-th senator s level and his loyalty The levels of all senators are integers in range from 1 to 9999 inclusive The loyalties of all senators are integers in range from 0 to 100 inclusive and all of them are divisible by 10,B,Dark Assembly is a governing body in the Netherworld Here sit the senators who take the most important decisions for the player For example to expand the range of the shop or to improve certain characteristics of the character the Dark Assembly s approval is needed The Dark Assembly consists of n senators Each of them is characterized by his level and loyalty to the player The level is a positive integer which reflects a senator s strength Loyalty is the probability of a positive decision in the voting which is measured as a percentage with precision of up to 10 Senators make decisions by voting Each of them makes a positive or negative decision in accordance with their loyalty If strictly more than half of the senators take a positive decision the player s proposal is approved If the player s proposal is not approved after the voting then the player may appeal against the decision of the Dark Assembly To do that player needs to kill all the senators that voted against there s nothing wrong in killing senators they will resurrect later and will treat the player even worse The probability that a player will be able to kill a certain group of senators is equal to A A B where A is the sum of levels of all player s characters and B is the sum of levels of all senators in this group If the player kills all undesired senators then his proposal is approved Senators are very fond of sweets They can be bribed by giving them candies For each received candy a senator increases his loyalty to the player by 10 It s worth to mention that loyalty cannot exceed 100 The player can take no more than k sweets to the courtroom Candies should be given to the senators before the start of voting Determine the probability that the Dark Assembly approves the player s proposal if the candies are distributed among the senators in the optimal way,256 megabytes,Print one real number with precision 10 - 6 the maximal possible probability that the Dark Assembly approves the player s proposal for the best possible distribution of candies among the senators,['brute force'/ 'probabilities'],2 seconds,B Dark Assembly
105,The first line contains number n 3 n 100 representing how many items Laharl has Then follow n lines Each line contains description of an item The description has the following form name class atk def res size the item s name class basic attack defense and resistance parameters and its size correspondingly name and class are strings and atk def res and size are integers name consists of lowercase Latin letters and its length can range from 1 to 10 inclusive class can be weapon armor or orb 0 atk def res 1000 1 size 10 It is guaranteed that Laharl has at least one item of each class The next line contains an integer k 1 k 1000 the number of residents Then k lines follow Each of them describes a resident A resident description looks like name type bonus home the resident s name his type the number of points the resident adds to the item s corresponding parameter and the name of the item which currently contains the resident name type and home are strings and bonus is an integer name consists of lowercase Latin letters and its length can range from 1 to 10 inclusive type may be gladiator sentry or physician 1 bonus 100 It is guaranteed that the number of residents in each item does not exceed the item s size The names of all items and residents are pairwise different All words and numbers in the input are separated by single spaces,C,Each item in the game has a level The higher the level is the higher basic parameters the item has We shall consider only the following basic parameters attack atk defense def and resistance to different types of impact res Each item belongs to one class In this problem we will only consider three of such classes weapon armor orb Besides there s a whole new world hidden inside each item We can increase an item s level travelling to its world We can also capture the so-called residents in the Item WorldResidents are the creatures that live inside items Each resident gives some bonus to the item in which it is currently located We will only consider residents of types gladiator who improves the item s atk sentry who improves def and physician who improves res Each item has the size parameter The parameter limits the maximum number of residents that can live inside an item We can move residents between items Within one moment of time we can take some resident from an item and move it to some other item if it has a free place for a new resident We cannot remove a resident from the items and leave outside any of them should be inside of some item at any moment of time Laharl has a certain number of items He wants to move the residents between items so as to equip himself with weapon armor and a defensive orb The weapon s atk should be largest possible in the end Among all equipping patterns containing weapon s maximum atk parameter we should choose the ones where the armor s def parameter is the largest possible Among all such equipment patterns we should choose the one where the defensive orb would have the largest possible res parameter Values of the parameters def and res of weapon atk and res of armor and atk and def of orb are indifferent for Laharl Find the optimal equipment pattern Laharl can get,256 megabytes,Print on the first line the name of the weapon in the optimal equipping pattern then print the number of residents the weapon contains then print the residents names Print on the second and third lines in the same form the names of the armor and defensive orb as well as the residents they contain Use single spaces for separation If there are several possible solutions print any of them,['brute force'/ 'implementation'/ 'sortings'],2 seconds,C Item World
105,The first line contains two integers n and m 1 n m 300 the height and the width of the map in cells Then follow n line each of them contains m numbers the Geo Panels colors Then follow n more lines each of them contains m numbers the Geo Symbols description -1 means that the given position contains no Geo Symbol Otherwise the number represents the color of the Geo Symbol in the given position All colors are integers from 0 to 109 0 represents the transparent color The last line contains two integers x and y 1 x n 1 y m the row and the column where the Geo Symbol is placed that needs to be eliminated The rows are numbered from top to bottom the columns are numbered from left to right Coordinates are 1-based It is guaranteed that the position with coordinates x y contains a Geo Symbol,D,The maps in the game are divided into square cells called Geo Panels Some of these panels are painted We shall assume that the Geo Panels without color are painted the transparent color Besides the map has so-called Geo Symbols They look like pyramids of different colors including Geo Symbols of the transparent color Each Geo Symbol is located on one Geo Panel and each Geo Panel may contain no more than one Geo Symbol Geo Symbols can be eliminated To understand better what happens when a Geo Symbol is eliminated let us introduce some queue to which we will put the recently eliminated Geo Symbols Let s put at the head of the queue a Geo Symbol that was eliminated just now Next we will repeat the following operation Extract the Geo Symbol from the queue Look at the color of the panel containing the given Geo Symbol If it differs from transparent and differs from the color of the Geo Symbol then all Geo Panels of this color are repainted in the color of the given Geo Symbol transparent Geo Symbols repaint the Geo Panels transparent Repainting is executed in an infinite spiral strictly in the following order starting from the panel which contained the Geo Symbol In other words we select all the panels that need to be repainted and find their numbers in the infinite spiral whose center is placed in the position of the given Geo Symbol After that we repaint them in the order of the number s increasing If a panel contains another Geo Symbol and this panel is being repainted then the Geo Symbol is removed from the field and placed at the tail of the queue After repainting the Geo Symbol is completely eliminated and the next Geo Symbol is taken from the head of the queue if there is any and the process repeats The process ends if the queue is empty See the sample analysis for better understanding You know the colors of all the Geo Panels and the location of all the Geo Symbols Determine the number of repaintings which will occur if you destroy one of the Geo Symbols,256 megabytes,Print the single number the total number of repaintings after the Geo Symbol is eliminated Please do not use the lld specificator to read or write 64-bit integers in C It is preferred to use the cout stream you may also use the I64d specificator,['brute force'/ 'dsu'/ 'implementation'],1 second,D Entertaining Geodetics
105,The first line contains three integers Laharl s position his movement range and throwing range The second and the third lines describe Etna s and Flonne s parameters correspondingly in the similar form It is guaranteed that the three characters occupy distinct positions All numbers in the input are between 1 and 10 inclusive,E,You are given a straight half-line divided into segments of unit length which we will call positions The positions are numbered by positive integers that start with 1 from the end of half-line i e 1 2 3 and so on The distance between the positions is the absolute difference between the respective numbers Laharl Etna and Flonne occupy some positions on the half-line and they want to get to the position with the largest possible number They are originally placed in different positions Each of the characters can perform each of the following actions no more than once Move a certain distance Grab another character and lift him above the head Throw the lifted character a certain distance Each character has a movement range parameter They can only move to free positions assuming that distance between those positions doesn t exceed the movement range One character can lift another character if the distance between the two characters equals 1 and no one already holds that another character We can assume that the lifted character moves to the same position as the person who has lifted him and the position in which he stood before becomes free A lifted character cannot perform any actions and the character that holds him cannot walk Also each character has a throwing range parameter It is the distance at which this character can throw the one lifted above his head He can only throw a character to a free position and only when there is a lifted character We accept the situation when one person grabs another one who in his turn has the third character in his hands This forms a column of three characters For example Laharl can hold Etna while Etna holds Flonne In this case Etna and the Flonne cannot perform any actions and Laharl can only throw Etna together with Flonne at some distance Laharl Etna and Flonne perform actions in any order They perform actions in turns that is no two of them can do actions at the same time Determine the maximum number of position at least one of the characters can reach That is such maximal number x so that one of the characters can reach position x,256 megabytes,Print a single number the maximum ordinal number of position which either Laharl Etna or Flonne can reach,['brute force'],1 5 seconds,E Lift and Throw
106,The first line contains the tramp suit It is S H D or C The second line contains the description of the two different cards Each card is described by one word consisting of two symbols The first symbol stands for the rank 6 7 8 9 T J Q K and A and the second one stands for the suit S H D and C,A,There is a card game called Durak which means Fool in Russian The game is quite popular in the countries that used to form USSR The problem does not state all the game s rules explicitly you can find them later yourselves if you want To play durak you need a pack of 36 cards Each card has a suit S H D and C and a rank in the increasing order 6 7 8 9 T J Q K and A At the beginning of the game one suit is arbitrarily chosen as trump The players move like that one player puts one or several of his cards on the table and the other one should beat each of them with his cards A card beats another one if both cards have similar suits and the first card has a higher rank then the second one Besides a trump card can beat any non-trump card whatever the cards ranks are In all other cases you can not beat the second card with the first one You are given the trump suit and two different cards Determine whether the first one beats the second one or not,256 megabytes,Print YES without the quotes if the first cards beats the second one Otherwise print NO also without the quotes,['implementation'],2 seconds,A Card Game
106,The first line contains number n 1 n 100 Then follow n lines Each describes a laptop as speed ram hdd cost Besides speed ram hdd and cost are integers 1000 speed 4200 is the processor s speed in megahertz 256 ram 4096 the RAM volume in megabytes 1 hdd 500 is the HDD in gigabytes 100 cost 1000 is price in tugriks All laptops have different prices,B,Vasya is choosing a laptop The shop has n laptops to all tastes Vasya is interested in the following properties processor speed ram and hdd Vasya is a programmer and not a gamer which is why he is not interested in all other properties If all three properties of a laptop are strictly less than those properties of some other laptop then the first laptop is considered outdated by Vasya Among all laptops Vasya does not consider outdated he chooses the cheapest one There are very many laptops which is why Vasya decided to write a program that chooses the suitable laptop However Vasya doesn t have his own laptop yet and he asks you to help him,256 megabytes,Print a single number the number of a laptop Vasya will choose The laptops are numbered with positive integers from 1 to n in the order in which they are given in the input data,['brute force'/ 'implementation'],2 seconds,B Choosing Laptop
106,The first line contains 4 integers n m c0 and d0 1 n 1000 1 m 10 1 c0 d0 100 Each of the following m lines contains 4 integers The i-th line contains numbers ai bi ci and di 1 ai bi ci di 100,C,Lavrenty a baker is going to make several buns with stuffings and sell them Lavrenty has n grams of dough as well as m different stuffing types The stuffing types are numerated from 1 to m Lavrenty knows that he has ai grams left of the i-th stuffing It takes exactly bi grams of stuffing i and ci grams of dough to cook a bun with the i-th stuffing Such bun can be sold for di tugriks Also he can make buns without stuffings Each of such buns requires c0 grams of dough and it can be sold for d0 tugriks So Lavrenty can cook any number of buns with different stuffings or without it unless he runs out of dough and the stuffings Lavrenty throws away all excess material left after baking Find the maximum number of tugriks Lavrenty can earn,256 megabytes,Print the only number the maximum number of tugriks Lavrenty can earn,['chinese remainder theorem'/ 'geometry'],2 seconds,C Buns
106,The first line contains two integers n and m 3 n m 1000 Then follow n lines containing m integers each the island map s description stands for the sea It is guaranteed that all cells along the rectangle s perimeter are the sea stands for a penetrable square without any sights and the sights are marked with uppercase Latin letters from A to Z Not all alphabet letters can be used However it is guaranteed that at least one of them is present on the map All local sights are marked by different letters The next line contains number k 1 k 105 after which k lines follow Each line describes an instruction Each instruction possesses the form dir len where dir stands for the direction and len stands for the length of the way to walk dir can take values N S W and E for North South West and East correspondingly At that north is to the top South is to the bottom west is to the left and east is to the right len is an integer from 1 to 1000,D,Our brave travelers reached an island where pirates had buried treasure However as the ship was about to moor the captain found out that some rat ate a piece of the treasure map The treasure map can be represented as a rectangle n m in size Each cell stands for an islands square the square s side length equals to a mile Some cells stand for the sea and they are impenetrable All other cells are penetrable i e available and some of them contain local sights For example the large tree on the hills or the cave in the rocks Besides the map also has a set of k instructions Each instruction is in the following form Walk n miles in the y direction The possible directions are north south east and west If you follow these instructions carefully you should fulfill all of them one by one then you should reach exactly the place where treasures are buried Unfortunately the captain doesn t know the place where to start fulfilling the instructions as that very piece of the map was lost But the captain very well remembers that the place contained some local sight Besides the captain knows that the whole way goes through the island s penetrable squares The captain wants to know which sights are worth checking He asks you to help him with that,256 megabytes,Print all local sights that satisfy to the instructions as a string without any separators in the alphabetical order If no sight fits print no solution without the quotes,['brute force'/ 'implementation'],2 seconds,D Treasure Island
106,The first line of the input file contains integer n the number of planets 1 N 100 Each of the following n lines contains information about the planets The i-th line contains three integers xi yi zi the coordinates of the i-th planet - 104 xi yi zi 104 1 i n No two planets coincide,E,The Galaxy contains n planets there are many different living creatures inhabiting each planet And each creature can get into troubles Space rescuers know it perfectly well and they are always ready to help anyone who really needs help All you need to do is call for them Now the space rescuers plan to build the largest in the history of the Galaxy rescue station however the rescue station s location is yet to be determined As some cases are real emergencies the rescuers want to find such a point in the Galaxy from which it would be possible to get to the remotest planet in the minimum possible time In other words the rescuers need such point in the space that the distance between it and the planet remotest from it was minimal if we compare this point with all other possible points in the space Unfortunately the rescuers can t sole this problem As the planets are quite remote from each other they can be considered as points in Euclidean three-dimensional space The distance between points xi yi zi and xj yj zj can be calculated by the formula The rescue station can be positioned in any point in the space It can also coincide with some planet Galaxy is in danger Save the space rescuers and find the required point for them,256 megabytes,Print on the first line of the output file three space-separated real numbers x0 y0 z0 the coordinates for the future base If there are several solutions you are allowed to print any of them The answer will be accepted if the distance from this point to the remotest planet will differ from the juries variant in no more than 10 - 6 in absolute or relative value,['geometry'/ 'ternary search'],2 seconds,E Space Rescuers
107,The first line contains two space-separated integers n and p 1 n 1000 0 p n the number of houses and the number of pipes correspondingly Then p lines follow the description of p pipes The i-th line contains three integers ai bi di indicating a pipe of diameter di going from house ai to house bi 1 ai bi n ai bi 1 di 106 It is guaranteed that for each house there is at most one pipe going into it and at most one pipe going out of it,A,The German University in Cairo GUC dorm houses are numbered from 1 to n Underground water pipes connect these houses together Each pipe has certain direction water can flow only in this direction and not vice versa and diameter which characterizes the maximal amount of water it can handle For each house there is at most one pipe going into it and at most one pipe going out of it With the new semester starting GUC student and dorm resident Lulu wants to install tanks and taps at the dorms For every house with an outgoing water pipe and without an incoming water pipe Lulu should install a water tank at that house For every house with an incoming water pipe and without an outgoing water pipe Lulu should install a water tap at that house Each tank house will convey water to all houses that have a sequence of pipes from the tank to it Accordingly each tap house will receive water originating from some tank house In order to avoid pipes from bursting one week later like what happened last semester Lulu also has to consider the diameter of the pipes The amount of water each tank conveys should not exceed the diameter of the pipes connecting a tank to its corresponding tap Lulu wants to find the maximal amount of water that can be safely conveyed from each tank to its corresponding tap,256 megabytes,Print integer t in the first line the number of tank-tap pairs of houses For the next t lines print 3 integers per line separated by spaces tanki tapi and diameteri where tanki tapi 1 i t Here tanki and tapi are indexes of tank and tap houses respectively and diameteri is the maximum amount of water that can be conveyed All the t lines should be ordered increasingly by tanki,['dfs and similar'/ 'graphs'],1 second,A Dorm Water Supply
107,The first line contains three integers n m and h 1 n 100 1 m 1000 1 h m the number of players on the team the number of departments in GUC and Herr Wafa s department correspondingly The second line contains a single-space-separated list of m integers si 1 si 100 denoting the number of students in the i-th department Note that sh includes Herr Wafa,B,As a German University in Cairo GUC student and a basketball player Herr Wafa was delighted once he heard the news GUC is finally participating in the Annual Basketball Competition ABC A team is to be formed of n players all of which are GUC students However the team might have players belonging to different departments There are m departments in GUC numbered from 1 to m Herr Wafa s department has number h For each department i Herr Wafa knows number si how many students who play basketball belong to this department Herr Wafa was also able to guarantee a spot on the team using his special powers But since he hates floating-point numbers he needs your help at finding the probability that he will have at least one teammate belonging to his department Note that every possible team containing Herr Wafa is equally probable Consider all the students different from each other,256 megabytes,Print the probability that Herr Wafa will have at least one teammate from his department If there is not enough basketball players in GUC to participate in ABC print -1 The answer will be accepted if it has absolute or relative error not exceeding 10 - 6,['combinatorics'/ 'dp'/ 'probabilities'],1 second,B Basketball Team
107,The first line contains three integers n y and m 1 n 16 2001 y 1018 0 m 100 the number of professors the year for which the arrangement should be computed and the number of pairs of seats for which the seniority relation should be kept respectively The next m lines contain one pair of integers each ai bi indicating that professor on the ai-th seat is more senior than professor on the bi-th seat 1 ai bi n ai bi Some pair may be listed more than once Please do not use the lld specificator to read or write 64-bit integers in It is preferred to use the cin stream you may also use the I64d specificator,C,In the year 2500 the annual graduation ceremony in the German University in Cairo GUC has run smoothly for almost 500 years so far The most important part of the ceremony is related to the arrangement of the professors in the ceremonial hall Traditionally GUC has n professors Each professor has his seniority level All seniorities are different Let s enumerate the professors from 1 to n with 1 being the most senior professor and n being the most junior professor The ceremonial hall has n seats one seat for each professor Some places in this hall are meant for more senior professors than the others More specifically m pairs of seats are in senior-junior relation and the tradition requires that for all m pairs of seats ai bi the professor seated in senior position ai should be more senior than the professor seated in junior position bi GUC is very strict about its traditions which have been carefully observed starting from year 2001 The tradition requires that The seating of the professors changes every year Year 2001 ceremony was using lexicographically first arrangement of professors in the ceremonial hall Each consecutive year lexicographically next arrangement of the professors is used The arrangement of the professors is the list of n integers where the first integer is the seniority of the professor seated in position number one the second integer is the seniority of the professor seated in position number two etc Given n the number of professors y the current year and m pairs of restrictions output the arrangement of the professors for this year,256 megabytes,Print the order in which the professors should be seated in the requested year If by this year the GUC would have ran out of arrangements or the given senior-junior relation are contradictory print The times have changed without quotes,['bitmasks'/ 'dp'],2 seconds,C Arrangement
107,The first line contains two integers n and c 0 n 1018 0 c 1000 the number of crimes Zeyad would like to commit and the number of conditions he is aware of Then the definitions for c conditions follow There are 26 types of crimes Each crime definition consists of crime type a capital Latin letter and its multiplicity The multiplicity of each crime is a positive integer number and the product of all multiplicities does not exceed 123 Some conditions may be repeated in the input more than once Crime of multiplicity 1 is not yielding any punishment regardless of the number of times it was committed The strictness of the law is compensated by the fact that it s non-mandatory Obviously if some crime is not listed in the set of conditions then Zeyad will not consider it as committing it would unavoidably lead to the punishment Please do not use the lld specificator to read or write 64-bit integers in It is preferred to use the cin stream you may also use the I64d specificator,D,Zeyad wants to commit n crimes in Egypt and not be punished at the end There are several types of crimes For example bribery is a crime but is not considered such when repeated twice Therefore bribery is not considered a crime when repeated an even number of times Speeding is a crime but is not considered such when repeated a number of times which is a multiple of five More specifically c conditions on crime repetitions are known Each condition describes the crime type ti and its multiplicity mi If the number of times Zeyad committed the crime ti is a multiple of mi Zeyad will not be punished for crime ti Some crimes may be listed more than once In this case fulfilling at least one condition for this crime is enough to not be punished for it Of course if for certain crime the number of times Zeyad committed it is zero he is innocent with respect to this crime Now Zeyad is interested in a number of ways he can commit exactly n crimes without any punishment The order of commiting the crimes matters More formally two ways sequences w1 and w2 of committing n crimes are equal if w1i w2i for all 1 i n,256 megabytes,Output the number of different ways Zeyad can commit exactly n crimes with no punishment modulo 12345,['dp'/ 'matrices'],5 seconds,D Crime Management
107,The first line of input contains integer n 1 n 500 the number of photos on the wall Then follow n lines describing the photos each containing 8 single-space-separated integers coordinates of 4 vertices x1 y1 x2 y2 x3 y3 x4 y4 Each photo is a rectangle with a nonzero area The coordinates are integers not exceeding 104 by absolute value The coordinates of the rectangle are given in either clockwise or counterclockwise order,E,The night after the graduation ceremony graduate students of German University in Cairo GUC are playing darts As there s no real dart board available the photographs of members of the GUC upper management are being used So n rectangular photos are placed on the wall They can overlap arbitrary and even coincide The photos are not necessarily placed horizontally or vertically they could also be rotated before being pinned to the wall The score of one dart throw is simply the number of photos the dart went through Fatma has made a throw but her score was not recorded She only remembers that she did make it into at least one photo Assuming that the probability distribution of the throw is equal across the whole wall what would be the expectation of Fatma s score,256 megabytes,Print the expected score of the throw The answer will be accepted if it has absolute or relative error not exceeding 10 - 6,['geometry'/ 'probabilities'],5 seconds,E Darts
108,The first and only line of the input starts with a string with the format HH MM where HH is from 00 to 23 and MM is from 00 to 59 Both HH and MM have exactly two digits,A,Tattah is asleep if and only if Tattah is attending a lecture This is a well-known formula among Tattah s colleagues On a Wednesday afternoon Tattah was attending Professor HH s lecture At 12 21 right before falling asleep he was staring at the digital watch around Saher s wrist He noticed that the digits on the clock were the same when read from both directions i e a palindrome In his sleep he started dreaming about such rare moments of the day when the time displayed on a digital clock is a palindrome As soon as he woke up he felt destined to write a program that finds the next such moment However he still hasn t mastered the skill of programming while sleeping so your task is to help him,256 megabytes,Print the palindromic time of day that comes soonest after the time given in the input If the input time is palindromic output the soonest palindromic time after the input time,['implementation'/ 'strings'],2 seconds,A Palindromic Times
108,The first line contains integer n 2 n 105 the number of Gava s unsigned integer datatypes sizes The second line contains a single-space-separated list of n integers 1 ai 109 sizes of datatypes in bits Some datatypes may have equal sizes,B,Tattah s youngest brother Tuftuf is new to programming Since his older brother is such a good programmer his biggest dream is to outshine him Tuftuf is a student at the German University in Cairo GUC where he learns to write programs in Gava Today Tuftuf was introduced to Gava s unsigned integer datatypes Gava has n unsigned integer datatypes of sizes in bits a1 a2 an The i-th datatype have size ai bits so it can represent every integer between 0 and 2ai - 1 inclusive Tuftuf is thinking of learning a better programming language If there exists an integer x such that x fits in some type i in ai bits and x x does not fit in some other type j in aj bits where ai aj then Tuftuf will stop using Gava Your task is to determine Tuftuf s destiny,256 megabytes,Print YES if Tuftuf will stop using Gava and NO otherwise,['math'/ 'sortings'],2 seconds,B Datatypes
109,The single line contains an integer n 1 n 106 the sum of digits of the required lucky number,A,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not Petya wonders eagerly what minimum lucky number has the sum of digits equal to n Help him cope with the task,256 megabytes,Print on the single line the result the minimum lucky number whose sum of digits equals n If such number does not exist print -1,['brute force'/ 'implementation'],2 seconds,A Lucky Sum of Digits
109,The single line contains five integers pl pr vl vr and k 1 pl pr 109 1 vl vr 109 1 k 1000,B,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not Petya and his friend Vasya play an interesting game Petya randomly chooses an integer p from the interval pl pr and Vasya chooses an integer v from the interval vl vr also randomly Both players choose their integers equiprobably Find the probability that the interval min v p max v p contains exactly k lucky numbers,256 megabytes,On the single line print the result with an absolute error of no more than 10 - 9,['brute force'/ 'probabilities'],2 seconds,B Lucky Probability
109,The first line contains the single integer n 1 n 105 the number of tree vertexes Next n - 1 lines contain three integers each ui vi wi 1 ui vi n 1 wi 109 the pair of vertexes connected by the edge and the edge s weight,C,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not One day Petya encountered a tree with n vertexes Besides the tree was weighted i e each edge of the tree has weight a positive integer An edge is lucky if its weight is a lucky number Note that a tree with n vertexes is an undirected connected graph that has exactly n - 1 edges Petya wondered how many vertex triples i j k exists that on the way from i to j as well as on the way from i to k there must be at least one lucky edge all three vertexes are pairwise distinct The order of numbers in the triple matters that is the triple 1 2 3 is not equal to the triple 2 1 3 and is not equal to the triple 1 3 2 Find how many such triples of vertexes exist,256 megabytes,On the single line print the single number the answer Please do not use the lld specificator to read or write 64-bit numbers in It is recommended to use the cin cout streams or the I64d specificator,['dp'/ 'dsu'/ 'trees'],2 seconds,C Lucky Tree
109,The first line contains an integer n 1 n 105 the number of elements in the array The second line contains n positive integers not exceeding 109 the array that needs to be sorted in the non-decreasing order,D,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not Petya got an array consisting of n numbers it is the gift for his birthday Now he wants to sort it in the non-decreasing order However a usual sorting is boring to perform that s why Petya invented the following limitation one can swap any two numbers but only if at least one of them is lucky Your task is to sort the array according to the specified limitation Find any possible sequence of the swaps the number of operations in the sequence should not exceed 2n,256 megabytes,On the first line print number k 0 k 2n the number of the swaps in the sorting On the following k lines print one pair of distinct numbers a pair per line the indexes of elements to swap The numbers in the array are numbered starting from 1 If it is impossible to sort the given sequence print the single number -1 If there are several solutions output any Note that you don t have to minimize k Any sorting with no more than 2n swaps is accepted,['constructive algorithms'/ 'sortings'],3 seconds,D Lucky Sorting
109,The single line contains two integers a and l 1 a l 109 the interval s first number and the interval s length correspondingly,E,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not One day Petya came across an interval of numbers a a l - 1 Let F x be the number of lucky digits of number x Find the minimum b a b such that F a F b F a 1 F b 1 F a l - 1 F b l - 1,512 megabytes,On the single line print number b the answer to the problem,['brute force'/ 'math'],4 seconds,E Lucky Interval
11,The first line of the input contains two integer numbers n and d 2 n 2000 1 d 106 The second line contains space separated sequence b0 b1 bn - 1 1 bi 106,A,A sequence a0 a1 at - 1 is called increasing if ai - 1 ai for each i 0 i t You are given a sequence b0 b1 bn - 1 and a positive integer d In each move you may choose one element of the given sequence and add d to it What is the least number of moves required to make the given sequence increasing,64 megabytes,Output the minimal number of moves needed to make the sequence increasing,['constructive algorithms'/ 'implementation'/ 'math'],1 second,A Increasing Sequence
11,The input data consists of only one integer x - 109 x 109,B,Jack is working on his jumping skills recently Currently he s located at point zero of the number line He would like to get to the point x In order to train he has decided that he ll first jump by only one unit and each subsequent jump will be exactly one longer than the previous one He can go either left or right with each jump He wonders how many jumps he needs to reach x,64 megabytes,Output the minimal number of jumps that Jack requires to reach x,['math'],1 second,B Jumping Jack
11,The first line contains integer t 1 t 10000 where t is the number of test cases in the input Then test cases follow Each case starts with a line containing integers n and m 2 n m 250 where n is the number of rows and m is the number of columns The following n lines contain m characters each 0 or 1 The total number of characters in all test cases doesn t exceed 106 for any input file,C,You are given a 0-1 rectangular matrix What is the number of squares in it A square is a solid square frame border with linewidth equal to 1 A square should be at least 2 2 We are only interested in two types of squares squares with each side parallel to a side of the matrix squares with each side parallel to a diagonal of the matrix For example the following matrix contains only one square of the first type 0000000 0111100 0100100 0100100 0111100The following matrix contains only one square of the second type 00000000010000010100000100000000000Regardless of type a square must contain at least one 1 and can t touch by side or corner any foreign 1 Of course the lengths of the sides of each square should be equal How many squares are in the given matrix,64 megabytes,You should output exactly t lines with the answer to the i-th test case on the i-th line,['implementation'],2 seconds,C How Many Squares
11,The first line of input contains two integers n and m 1 n 19 0 m respectively the number of vertices and edges of the graph Each of the subsequent m lines contains two integers a and b 1 a b n a b indicating that vertices a and b are connected by an undirected edge There is no more than one edge connecting any pair of vertices,D,Given a simple graph output the number of simple cycles in it A simple cycle is a cycle with no repeated vertices or edges,256 megabytes,Output the number of cycles in the given graph,['bitmasks'/ 'dp'/ 'graphs'],2 seconds,D A Simple Task
11,The first line of input contains a sequence consisting only of characters L R and X where L corresponds to a step with the left foot R with the right foot and X to a break The length of the sequence will not exceed 106,E,Jack has become a soldier now Unfortunately he has trouble with the drill Instead of marching beginning with the left foot and then changing legs with each step as ordered he keeps repeating a sequence of steps in which he sometimes makes the wrong steps or horror of horrors stops for a while For example if Jack uses the sequence right left break when the sergeant yells Left Right Left Right Left Right Jack first makes a step with the right foot then one with the left foot then he is confused and stops for a moment then again - this time according to the order - starts with the right foot then uses the left foot then - to the sergeant s irritation - he stops to catch his breath to incorrectly start with the right foot again Marching this way Jack will make the step that he is supposed to in the given moment in only one third of cases When the officers convinced him he should do something about it Jack decided to modify the basic sequence of steps that he repeats However in order not to get too tired he has decided that the only thing he ll do is adding any number of breaks in any positions of the original sequence a break corresponds to stopping for the duration of one step Of course Jack can t make a step on the same foot twice in a row if there is no pause between these steps It is however not impossible that the sequence of steps he used so far is incorrect it would explain a lot actually Help Private Jack Given the sequence of steps he keeps repeating calculate the maximal percentage of time that he can spend marching correctly after adding some breaks to his scheme,64 megabytes,Output the maximum percentage of time that Jack can spend marching correctly rounded down to exactly six digits after the decimal point,['binary search'/ 'dp'/ 'greedy'],1 second,E Forward march
110,The only line contains an integer n 1 n 1018 Please do not use the lld specificator to read or write 64-bit numbers in It is preferred to use the cin cout streams or the I64d specificator,A,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not Unfortunately not all numbers are lucky Petya calls a number nearly lucky if the number of lucky digits in it is a lucky number He wonders whether number n is a nearly lucky number,256 megabytes,Print on the single line YES if n is a nearly lucky number Otherwise print NO without the quotes,['implementation'],2 seconds,A Nearly Lucky Number
110,The single line contains a positive integer n 1 n 105 the length of the sought string,B,Petya loves lucky numbers We all know that lucky numbers are the positive integers whose decimal representations contain only the lucky digits 4 and 7 For example numbers 47 744 4 are lucky and 5 17 467 are not Petya recently learned to determine whether a string of lowercase Latin letters is lucky For each individual letter all its positions in the string are written out in the increasing order This results in 26 lists of numbers some of them can be empty A string is considered lucky if and only if in each list the absolute difference of any two adjacent numbers is a lucky number For example let s consider string zbcdzefdzc The lists of positions of equal letters are b 2 c 3 10 d 4 8 e 6 f 7 z 1 5 9 Lists of positions of letters a g h y are empty This string is lucky as all differences are lucky numbers For letters z 5 - 1 4 9 - 5 4 for letters c 10 - 3 7 for letters d 8 - 4 4 Note that if some letter occurs only once in a string it doesn t influence the string s luckiness after building the lists of positions of equal letters The string where all the letters are distinct is considered lucky Find the lexicographically minimal lucky string whose length equals n,256 megabytes,Print on the single line the lexicographically minimal lucky string whose length equals n,['constructive algorithms'/ 'strings'],2 seconds,B Lucky String
111,The first line contains three space-separated integers n x and y 1 n 105 1 x 1012 1 y 106 Please do not use the lld specificator to read or write 64-bit integers in It is recommended to use cin cout streams or the I64d specificator,A,Little Petya loves inequations Help him find n positive integers a1 a2 an such that the following two conditions are satisfied a12 a22 an2 x a1 a2 an y,256 megabytes,Print n positive integers that satisfy the conditions one integer per line If such numbers do not exist print a single number -1 If there are several solutions print any of them,['greedy'],2 seconds,A Petya and Inequiations
111,The first line contains an integer n 1 n 105 Each of the following n lines contain two space-separated integers xi and yi 1 xi 105 0 yi i - 1 where i is the query s ordinal number the numeration starts with 1 If yi 0 for the query then the answer to the query will be the number of divisors of the number xi In this case you do not need to take the previous numbers x into consideration,B,Little Petya loves looking for numbers divisors One day Petya came across the following problem You are given n queries in the form xi yi For each query Petya should count how many divisors of number xi divide none of the numbers xi - yi xi - yi 1 xi - 1 Help him,256 megabytes,For each query print the answer on a single line the number of positive integers k such that,['binary search'/ 'data structures'/ 'number theory'],5 seconds,B Petya and Divisors
111,The first line contains two space-separated integers n and m 1 n m 40 n m 40 the board sizes,C,Little Petya loves training spiders Petya has a board n m in size Each cell of the board initially has a spider sitting on it After one second Petya chooses a certain action for each spider and all of them humbly perform its commands There are 5 possible commands to stay idle or to move from current cell to some of the four side-neighboring cells that is one command for each of the four possible directions Petya gives the commands so that no spider leaves the field It is allowed for spiders to pass through each other when they crawl towards each other in opposite directions All spiders crawl simultaneously and several spiders may end up in one cell Petya wants to know the maximum possible number of spider-free cells after one second,256 megabytes,In the first line print the maximum number of cells without spiders,['bitmasks'/ 'dp'/ 'dsu'],2 seconds,C Petya and Spiders
111,The first line contains space-separated integers n m and k 1 n m 1000 1 k 106 the board s vertical and horizontal sizes and the number of colors respectively,D,Little Petya loves counting He wants to count the number of ways to paint a rectangular checkered board of size n m n rows m columns in k colors Besides the coloring should have the following property for any vertical line that passes along the grid lines and divides the board in two non-empty parts the number of distinct colors in both these parts should be the same Help Petya to count these colorings,256 megabytes,Print the answer to the problem As the answer can be quite a large number you should print it modulo 109 7 1000000007,['combinatorics'/ 'dp'],5 seconds,D Petya and Coloring
111,The first line contains space-separated integers n and m 4 n m 1000 the number of rows and the number of columns in the rectangle correspondingly The second line contains space-separated integers x1 and y1 the coordinates of the first marked cell The third line contains space-separated integers x2 y2 the coordinates of the second marked cell 1 x1 x2 n 1 y1 y2 m x1 x2 y1 y2 The coordinates of a marked cell are a pair of integers x y where x represents the row s number and y represents the column s number The rows are numbered from top to bottom with consecutive integers from 1 to n The columns are numbered from the left to the right by consecutive integers from 1 to m It is guaranteed that the marked cells are not positioned in one row or column,E,Little Petya loves playing with rectangles Mom bought Petya a rectangle divided into cells n m in size containing n rows m columns Petya marked two different cells of the rectangle and now he is solving the following task Let s define a simple path between those two cells as a sequence of distinct cells a1 a2 ak where a1 and ak are the two marked cells Besides ai and ai 1 are side-neighboring cells of the path 1 i k Let s denote the path length as number k the sequence length Petya s task is to find the longest simple path s length and to print the path Help him,256 megabytes,In the first line print the length of the found path k In the next lines print k pairs of integers one per line coordinates of the cells that constitute the found path in the order in which they follow in the path the path must go from cell x1 y1 to cell x2 y2 If there are several solutions print any of them,[],5 seconds,E Petya and Rectangle
112,Each of the first two lines contains a bought string The strings lengths range from 1 to 100 inclusive It is guaranteed that the strings are of the same length and also consist of uppercase and lowercase Latin letters,A,Little Petya loves presents His mum bought him two strings of the same size for his birthday The strings consist of uppercase and lowercase Latin letters Now Petya wants to compare those two strings lexicographically The letters case does not matter that is an uppercase letter is considered equivalent to the corresponding lowercase letter Help Petya perform the comparison,256 megabytes,If the first string is less than the second one print -1 If the second string is less than the first one print 1 If the strings are equal print 0 Note that the letters case is not taken into consideration when the strings are compared,['implementation'/ 'strings'],2 seconds,A Petya and Strings
112,The first line contains three space-separated integers 2n x and y 2 2n 100 1 x y 2n representing the length of a square s side and the coordinates of the marked cell It is guaranteed that 2n is even The coordinates of the marked cell are represented by a pair of numbers x y where x represents the number of the row and y represents the number of the column The rows and columns are numbered by consecutive integers from 1 to 2n The rows are numbered from top to bottom and the columns are numbered from the left to the right,B,Little Petya loves playing with squares Mum bought him a square 2n 2n in size Petya marked a cell inside the square and now he is solving the following task The task is to draw a broken line that would go along the grid lines and that would cut the square into two equal parts The cutting line should not have any common points with the marked cell and the resulting two parts should be equal up to rotation Petya wants to determine whether it is possible to cut the square in the required manner given the sizes of the square side and the coordinates of the marked cell Help him,256 megabytes,If the square is possible to cut print YES otherwise print NO without the quotes,['implementation'/ 'math'],2 seconds,B Petya and Square
113,The first line contains one or more words consisting of lowercase Latin letters The overall number of characters including letters and spaces does not exceed 105 It is guaranteed that any two consecutive words are separated by exactly one space and the input data do not contain any other spaces It is possible that given words do not belong to the Petya s language,A,Petya got interested in grammar on his third year in school He invented his own language called Petya s Petya wanted to create a maximally simple language that would be enough to chat with friends that s why all the language s grammar can be described with the following set of rules There are three parts of speech the adjective the noun the verb Each word in his language is an adjective noun or verb There are two genders masculine and feminine Each word in his language has gender either masculine or feminine Masculine adjectives end with -lios and feminine adjectives end with -liala Masculine nouns end with -etr and feminime nouns end with -etra Masculine verbs end with -initis and feminime verbs end with -inites Thus each word in the Petya s language has one of the six endings given above There are no other endings in Petya s language It is accepted that the whole word consists of an ending That is words lios liala etr and so on belong to the Petya s language There aren t any punctuation marks grammatical tenses singular plural forms or other language complications A sentence is either exactly one valid language word or exactly one statement Statement is any sequence of the Petya s language that satisfy both conditions Words in statement follow in the following order from the left to the right zero or more adjectives followed by exactly one noun followed by zero or more verbs All words in the statement should have the same gender After Petya s friend Vasya wrote instant messenger an instant messaging program that supported the Petya s language Petya wanted to add spelling and grammar checking to the program As Vasya was in the country and Petya didn t feel like waiting he asked you to help him with this problem Your task is to define by a given sequence of words whether it is true that the given text represents exactly one sentence in Petya s language,256 megabytes,If some word of the given text does not belong to the Petya s language or if the text contains more that one sentence print NO without the quotes Otherwise print YES without the quotes,['implementation'/ 'strings'],5 seconds,A Grammar Lessons
113,The input file consists of three lines The first line contains string t The second and the third lines contain the sbegin and send identificators correspondingly All three lines are non-empty strings consisting of lowercase Latin letters The length of each string doesn t exceed 2000 characters,B,Long ago when Petya was a schoolboy he was very much interested in the Petr language grammar During one lesson Petya got interested in the following question how many different continuous substrings starting with the sbegin and ending with the send it is possible sbegin send the given string t has Substrings are different if and only if their contents aren t equal their positions of occurence don t matter Petya wasn t quite good at math that s why he couldn t count this number Help him,256 megabytes,Output the only number the amount of different substrings of t that start with sbegin and end with send,['brute force'/ 'data structures'/ 'hashing'/ 'strings'],2 seconds,B Petr
113,The first line of the input contains integer numbers l r 1 l r 3 108,C,On the math lesson a teacher asked each pupil to come up with his own lucky numbers As a fan of number theory Peter chose prime numbers Bob was more original He said that number t is his lucky number if it can be represented as t a2 b2 where a b are arbitrary positive integers Now the boys decided to find out how many days of the interval l r l r are suitable for pair programming They decided that the day i l i r is suitable for pair programming if and only if the number i is lucky for Peter and lucky for Bob at the same time Help the boys to find the number of such days,128 megabytes,In the only line print the number of days on the segment l r which are lucky for Peter and Bob at the same time,['brute force'/ 'number theory'],3 seconds,C Double Happiness
113,The first line contains four integers n 1 n 22 representing the numbers of rooms m representing the number of corridors a b 1 a b n representing the numbers of Petya s and Vasya s starting rooms correspondingly Next m lines contain pairs of numbers the numbers of rooms connected by a corridor Next n lines contain probabilities pi 0 01 pi 0 99 with the accuracy of up to four digits after the decimal point the probability to stay in room i It is guaranteed that every room can be reached from every other room by corridors,D,One day as Petya and his friend Vasya were having one of their numerous trips they decided to visit a museum castle The museum has a specific shape it consists of n rooms connected with m corridors so that one can access any room from any other one After the two friends had a little walk around the museum they decided to split and watch the pieces of art each of them found interesting They agreed to meet in one of the rooms at six p m However they forgot one quite essential thing they didn t specify the place to meet and when the time came they started to rush about the museum looking for each other they couldn t call each other as roaming made a call s cost skyrocket Yet even despite the whole rush they couldn t get enough of the pieces of art that s why each of them has the following strategy each minute he make a decision where to go with probability pi he doesn t move to any other place during this minute i e he stays in the room With probability 1 - pi he equiprobably choose one of the adjacent rooms and went there along the corridor Here i is the ordinal number of the current room Building was expensive in ancient times that s why each corridor connected two different rooms and any two rooms had no more than one corridor between them The boys act simultaneously As the corridors are dark it is impossible to meet there however one can walk along the corridors in both directions besides the two boys can be going through the same corridor simultaneously without meeting The boys act like that until they meet each other More formally the two friends meet when at some moment of time both of them decided to appear in the same room For each room find the probability that the boys will meet there considering that at 6 p m they are positioned in rooms a and b correspondingly,256 megabytes,In the only line print n space-separated numbers the i-th number should represent the probability that the friends meet in the i-th room with absolute or relative error of no more than 10 - 6,['matrices'/ 'probabilities'],2 seconds,D Museum
113,The first line of the input file contains three space-separated integers h m and k 2 h m 109 1 k 20 The second line contains space-separated integers h1 m1 0 h1 h 0 m1 m The third line contains space-separated integers h2 m2 0 h2 h 0 m2 m,E,One day Vasya was lying in bed watching his electronic clock to fall asleep quicker Vasya lives in a strange country where days have h hours and every hour has m minutes Clock shows time in decimal number system in format H M where the string H always has a fixed length equal to the number of digits in the decimal representation of number h - 1 To achieve this leading zeros are added if necessary The string M has a similar format and its length is always equal to the number of digits in the decimal representation of number m - 1 For example if h 17 m 1000 then time equal to 13 hours and 75 minutes will be displayed as 13 075 Vasya had been watching the clock from h1 hours m1 minutes to h2 hours m2 minutes inclusive and then he fell asleep Now he asks you to count how many times he saw the moment at which at least k digits changed on the clock simultaneously For example when switching 04 19 04 20 two digits change When switching 23 59 00 00 four digits change Consider that Vasya has been watching the clock for strictly less than one day Note that the last time Vasya saw on the clock before falling asleep was h2 m2 That is Vasya didn t see the moment at which time h2 m2 switched to the next value,256 megabytes,Print a single number the number of times Vasya saw the moment of changing at least k digits simultaneously Please do not use the lld specificator to read or write 64-bit integers in C It is preferred to use the cin stream also you may use the I64d specificator,['combinatorics'/ 'implementation'/ 'math'],2 seconds,E Sleeping
114,The first input line contains integer number k the second line contains integer number l 2 k l 231 - 1,A,When Petya went to school he got interested in large numbers and what they were called in ancient times For instance he learned that the Russian word tma which now means too much to be counted used to stand for a thousand and tma tmyschaya which literally means the tma of tmas used to stand for a million Petya wanted to modernize the words we use for numbers and invented a word petricium that represents number k Moreover petricium la petricium stands for number k2 petricium la petricium la petricium stands for k3 and so on All numbers of this form are called petriciumus cifera and the number s importance is the number of articles la in its title Petya s invention brought on a challenge that needed to be solved quickly does some number l belong to the set petriciumus cifera As Petya is a very busy schoolboy he needs to automate the process he asked you to solve it,256 megabytes,You should print in the first line of the output YES if the number belongs to the set petriciumus cifera and otherwise print NO If the number belongs to the set then print on the seconds line the only number the importance of number l,['math'],2 seconds,A Cifera
114,The first line contains two integer numbers n 1 n 16 the number of volunteers and m the number of pairs that do not get on Next n lines contain the volunteers names each name is a non-empty string consisting of no more than 10 uppercase and or lowercase Latin letters Next m lines contain two names the names of the volunteers who do not get on The names in pair are separated with a single space Each pair of volunteers who do not get on occurs exactly once The strings are case-sensitive All n names are distinct,B,When little Petya grew up and entered the university he started to take part in contests Later he realized that he doesn t like how the contests are organised the team could only have three members and he couldn t take all his friends to the competitions and distribute the tasks between the team members efficiently so he decided to organize his own contests PFAST Inc Petr and Friends Are Solving Tasks Corporation PFAST Inc rules allow a team to have unlimited number of members To make this format of contests popular he organised his own tournament To create the team he will prepare for the contest organised by the PFAST Inc rules he chose several volunteers up to 16 people and decided to compile a team from them Petya understands perfectly that if a team has two people that don t get on well then the team will perform poorly Put together a team with as many players as possible given that all players should get on well with each other,256 megabytes,The first output line should contain the single number k the number of people in the sought team Next k lines should contain the names of the sought team s participants in the lexicographical order If there are several variants to solve the problem print any of them Petya might not be a member of the sought team,['bitmasks'/ 'brute force'],2 seconds,B PFAST Inc
115,The first line contains integer n 1 n 2000 the number of employees The next n lines contain the integers pi 1 pi n or pi -1 Every pi denotes the immediate manager for the i-th employee If pi is -1 that means that the i-th employee does not have an immediate manager It is guaranteed that no employee will be the immediate manager of him herself pi i Also there will be no managerial cycles,A,A company has n employees numbered from 1 to n Each employee either has no immediate manager or exactly one immediate manager who is another employee with a different number An employee A is said to be the superior of another employee B if at least one of the following is true Employee A is the immediate manager of employee B Employee B has an immediate manager employee C such that employee A is the superior of employee C The company will not have a managerial cycle That is there will not exist an employee who is the superior of his her own immediate manager Today the company is going to arrange a party This involves dividing all n employees into several groups every employee must belong to exactly one group Furthermore within any single group there must not be two employees A and B such that A is the superior of B What is the minimum number of groups that must be formed,256 megabytes,Print a single integer denoting the minimum number of groups that will be formed in the party,['dfs and similar'/ 'graphs'/ 'trees'],3 seconds,A Party
115,The first line contains two integers n and m 1 n m 150 the number of rows and columns respectively Then follow n lines containing m characters each the content of the grid G means that this cell contains grass W means that this cell contains weeds It is guaranteed that the top-left corner of the grid will contain grass,B,You have a garden consisting entirely of grass and weeds Your garden is described by an n m grid with rows numbered 1 to n from top to bottom and columns 1 to m from left to right Each cell is identified by a pair r c which means that the cell is located at row r and column c Each cell may contain either grass or weeds For example a 4 5 garden may look as follows empty cells denote grass You have a land-mower with you to mow all the weeds Initially you are standing with your lawnmower at the top-left corner of the garden That is at cell 1 1 At any moment of time you are facing a certain direction either left or right And initially you face right In one move you can do either one of these 1 Move one cell in the direction that you are facing if you are facing right move from cell r c to cell r c 1 if you are facing left move from cell r c to cell r c - 1 2 Move one cell down that is from cell r c to cell r 1 c and change your direction to the opposite one if you were facing right previously you will face left if you were facing left previously you will face right You are not allowed to leave the garden Weeds will be mowed if you and your lawnmower are standing at the cell containing the weeds your direction doesn t matter This action isn t counted as a move What is the minimum number of moves required to mow all the weeds,256 megabytes,Print a single number the minimum number of moves required to mow all the weeds,['greedy'/ 'sortings'],2 seconds,B Lawnmower
115,The first line will contain two single-space separated integers n and m 1 n m n m 5 105 the number of rows and columns respectively Then n lines follow each contains exactly m characters the description of the grid Each character describes a cell and is either one of these 1 - 4 a pipe segment of one of four types as described above an empty cell,C,Little John aspires to become a plumber Today he has drawn a grid consisting of n rows and m columns consisting of n m square cells In each cell he will draw a pipe segment He can only draw four types of segments numbered from 1 to 4 illustrated as follows Each pipe segment has two ends illustrated by the arrows in the picture above For example segment 1 has ends at top and left side of it Little John considers the piping system to be leaking if there is at least one pipe segment inside the grid whose end is not connected to another pipe s end or to the border of the grid The image below shows an example of leaking and non-leaking systems of size 1 2 Now you will be given the grid that has been partially filled by Little John Each cell will either contain one of the four segments above or be empty Find the number of possible different non-leaking final systems after Little John finishes filling all of the empty cells with pipe segments Print this number modulo 1000003 106 3 Note that rotations or flipping of the grid are not allowed and so two configurations that are identical only when one of them has been rotated or flipped either horizontally or vertically are considered two different configurations,256 megabytes,Print a single integer denoting the number of possible final non-leaking pipe systems modulo 1000003 106 3 If there are no such configurations print 0,['math'],3 seconds,C Plumber
115,The first line is a non-empty string consisting of digits 0 - 9 and characters - and or Its length will not exceed 2000 The line doesn t contain any spaces,D,Let s define an unambiguous arithmetic expression UAE as follows All non-negative integers are UAE s Integers may have leading zeroes for example 0000 and 0010 are considered valid integers If X and Y are two UAE s then X Y X - Y X Y and X Y all without the double quotes are UAE s If X is an UAE then - X and X both without the double quotes are UAE s You are given a string consisting only of digits 0 - 9 and characters - and Your task is to compute the number of different possible unambiguous arithmetic expressions such that if all brackets characters and of that unambiguous arithmetic expression are removed it becomes the input string Since the answer may be very large print it modulo 1000003 106 3,256 megabytes,Print a single integer representing the number of different unambiguous arithmetic expressions modulo 1000003 106 3 such that if all its brackets are removed it becomes equal to the input string character-by-character,['dp'/ 'expression parsing'],2 seconds,D Unambiguous Arithmetic Expression
115,The first line contains two single-space separated integers n and m 1 n m 2 105 denoting the number of roads and the number of races respectively Then n lines follow each line will contain a single non-negative integer not exceeding 109 denoting the cost to repair a road The costs are given in order from road 1 to road n Finally m lines follow Each line is single-space-separated triplets of integers Each triplet will be given as lb ub and p 1 lb ub n 1 p 109 which means that the race these three integers describe will use all the roads from lb to ub inclusive and if it s held you get p,E,You are a car race organizer and would like to arrange some races in Linear Kingdom Linear Kingdom has n consecutive roads spanning from left to right The roads are numbered from 1 to n from left to right thus the roads follow in the order of their numbers increasing There will be several races that may be held on these roads Each race will use a consecutive subset of these roads Also each race will pay some amount of money to you if this race is held No races overlap in time so some roads can be used in several races Unfortunately some of the roads are in a bad condition and they need repair Each road has repair costs associated with it you are required to pay this cost to repair the road A race can only take place if all the roads used in the race are renovated Your task is to repair such roads possibly all or none that will maximize your profit Your profit is defined as the total money you get from the races that are held minus the total money you spent to repair the roads Note that you may decide not to repair any road and gain zero profit Print the maximum profit you can gain,256 megabytes,Print a single integer denoting the maximum possible profit you can gain Please do not use the lld specificator to read or write 64-bit integers in C It is recommended to use cin cout stream also you may use I64d specificator,['data structures'/ 'dp'],5 seconds,E Linear Kingdom Races
116,The first line contains a single number n 2 n 1000 the number of the tram s stops Then n lines follow each contains two integers ai and bi 0 ai bi 1000 the number of passengers that exits the tram at the i-th stop and the number of passengers that enter the tram at the i-th stop The stops are given from the first to the last stop in the order of tram s movement The number of people who exit at a given stop does not exceed the total number of people in the tram immediately before it arrives at the stop More formally This particularly means that a1 0 At the last stop all the passengers exit the tram and it becomes empty More formally No passenger will enter the train at the last stop That is bn 0,A,Linear Kingdom has exactly one tram line It has n stops numbered from 1 to n in the order of tram s movement At the i-th stop ai passengers exit the tram while bi passengers enter it The tram is empty before it arrives at the first stop Also when the tram arrives at the last stop all passengers exit so that it becomes empty Your task is to calculate the tram s minimum capacity such that the number of people inside the tram at any time never exceeds this capacity Note that at each stop all exiting passengers exit before any entering passenger enters the tram,256 megabytes,Print a single integer denoting the minimum possible capacity of the tram 0 is allowed,['implementation'],2 seconds,A Tram
116,The first line contains integers n and m 1 n m 10 which denotes the number of rows and columns in our two-dimensional grid respectively Then follow n lines containing m characters each that is the grid description means that this cell is empty P means that this cell contains a little pig W means that this cell contains a wolf It is guaranteed that there will be at most one wolf adjacent to any little pig,B,Once upon a time there were several little pigs and several wolves on a two-dimensional grid of size n m Each cell in this grid was either empty containing one little pig or containing one wolf A little pig and a wolf are adjacent if the cells that they are located at share a side The little pigs are afraid of wolves so there will be at most one wolf adjacent to each little pig But each wolf may be adjacent to any number of little pigs They have been living peacefully for several years But today the wolves got hungry One by one each wolf will choose one of the little pigs adjacent to it if any and eats the poor little pig This process is not repeated That is each wolf will get to eat at most one little pig Once a little pig gets eaten it disappears and cannot be eaten by any other wolf What is the maximum number of little pigs that may be eaten by the wolves,256 megabytes,Print a single number the maximal number of little pigs that may be eaten by the wolves,['greedy'/ 'implementation'],2 seconds,B Little Pigs and Wolves
117,The first line contains two space-separated integers n and m 1 n 105 2 m 108 Next n lines contain information about the participants in the form of three space-separated integers si fi ti 1 si fi m 0 ti 108 described in the problem statement,A,And now the numerous qualifying tournaments for one of the most prestigious Russian contests Russian Codec Cup are over All n participants who have made it to the finals found themselves in a huge m-floored 108-star hotel Of course the first thought to come in a place like this is How about checking out the elevator The hotel s elevator moves between floors according to one never changing scheme Initially at the moment of time 0 the elevator is located on the 1-st floor then it moves to the 2-nd floor then to the 3-rd floor and so on until it reaches the m-th floor After that the elevator moves to floor m - 1 then to floor m - 2 and so on until it reaches the first floor This process is repeated infinitely We know that the elevator has infinite capacity we also know that on every floor people get on the elevator immediately Moving between the floors takes a unit of time For each of the n participant you are given si which represents the floor where the i-th participant starts fi which represents the floor the i-th participant wants to reach and ti which represents the time when the i-th participant starts on the floor si For each participant print the minimum time of his her arrival to the floor fi If the elevator stops on the floor si at the time ti then the i-th participant can enter the elevator immediately If the participant starts on the floor si and that s the floor he wanted to reach initially si fi then the time of arrival to the floor fi for this participant is considered equal to ti,256 megabytes,Print n lines each containing one integer the time of the arrival for each participant to the required floor,['implementation'/ 'math'],1 second,A Elevator
117,The first line contains three integers a b mod 0 a b 109 1 mod 107,B,In a very ancient country the following game was popular Two people play the game Initially first player writes a string s1 consisting of exactly nine digits and representing a number that does not exceed a After that second player looks at s1 and writes a string s2 consisting of exactly nine digits and representing a number that does not exceed b Here a and b are some given constants s1 and s2 are chosen by the players The strings are allowed to contain leading zeroes If a number obtained by the concatenation joining together of strings s1 and s2 is divisible by mod then the second player wins Otherwise the first player wins You are given numbers a b mod Your task is to determine who wins if both players play in the optimal manner If the first player wins you are also required to find the lexicographically minimum winning move,256 megabytes,If the first player wins print 1 and the lexicographically minimum string s1 he has to write to win If the second player wins print the single number 2,['brute force'/ 'number theory'],2 seconds,B Very Interesting Game
117,The first line contains an integer n 1 n 5000 Next n lines contain the adjacency matrix A of the graph without spaces Ai j 1 if the graph has an edge going from vertex i to vertex j otherwise Ai j 0 Ai j stands for the j-th character in the i-th line It is guaranteed that the given graph is a tournament that is Ai i 0 Ai j Aj i 1 i j n i j,C,A tournament is a directed graph without self-loops in which every pair of vertexes is connected by exactly one directed edge That is for any two vertexes u and v u v exists either an edge going from u to v or an edge from v to u You are given a tournament consisting of n vertexes Your task is to find there a cycle of length three,256 megabytes,Print three distinct vertexes of the graph a1 a2 a3 1 ai n such that Aa1 a2 Aa2 a3 Aa3 a1 1 or -1 if a cycle whose length equals three does not exist If there are several solutions print any of them,['dfs and similar'/ 'graphs'],2 5 seconds,C Cycle
117,The first line contains three integers n m mod 1 n 1018 1 m 105 1 mod 109 Next m lines describe the queries Each query is defined by four integers l r u v 1 l r n 1 u v 1018 Please do not use the lld specificator to read or write 64-bit integers in C Use I64d specificator,D,Let a be an array consisting of n numbers The array s elements are numbered from 1 to n even is an array consisting of the numerals whose numbers are even in a eveni a2i 1 2i n odd is an array consisting of the numberals whose numbers are odd in oddi a2i - 1 1 2i - 1 n Then let s define the transformation of array F a in the following manner if n 1 F a F odd F even where operation stands for the arrays concatenation joining together if n 1 F a a Let a be an array consisting of n numbers 1 2 3 n Then b is the result of applying the transformation to the array a so b F a You are given m queries l r u v Your task is to find for each query the sum of numbers bi such that l i r and u bi v You should print the query results modulo mod,256 megabytes,Print m lines each containing an integer remainder modulo mod of the query result,['divide and conquer'/ 'math'],6 seconds,D Not Quick Transformation
117,The first line contains two integers n and m 3 n 105 1 m 105 Then n lines describe the graph edges as a b 1 a b n Next m lines contain the queries as v u 1 v u n It is guaranteed that the graph is connected does not have any self-loops or multiple edges,E,You are given an undirected connected graph G consisting of n vertexes and n edges G contains no self-loops or multiple edges Let each edge has two states on and off Initially all edges are switched off You are also given m queries represented as v u change the state of all edges on the shortest path from vertex v to vertex u in graph G If there are several such paths the lexicographically minimal one is chosen More formally let us consider all shortest paths from vertex v to vertex u as the sequences of vertexes v v1 v2 u Among such sequences we choose the lexicographically minimal one After each query you should tell how many connected components has the graph whose vertexes coincide with the vertexes of graph G and edges coincide with the switched on edges of graph G,256 megabytes,Print m lines each containing one integer the query results,['data structures'/ 'divide and conquer'/ 'implementation'/ 'trees'],5 seconds,E Tree or not Tree
118,The first line represents input string of Petya s program This string only consists of uppercase and lowercase Latin letters and its length is from 1 to 100 inclusive,A,Petya started to attend programming lessons On the first lesson his task was to write a simple program The program was supposed to do the following in the given string consisting if uppercase and lowercase Latin letters it deletes all the vowels inserts a character before each consonant replaces all uppercase consonants with corresponding lowercase ones Vowels are letters A O Y E U I and the rest are consonants The program s input is exactly one string it should return the output as a single string resulting after the program s processing the initial string Help Petya cope with this easy task,256 megabytes,Print the resulting string It is guaranteed that this string is not empty,['implementation'/ 'strings'],2 seconds,A String Task
118,The first line contains the single integer n 2 n 9,B,Vasya s birthday is approaching and Lena decided to sew a patterned handkerchief to him as a present Lena chose digits from 0 to n as the pattern The digits will form a rhombus The largest digit n should be located in the centre The digits should decrease as they approach the edges For example for n 5 the handkerchief pattern should look like that 0 0 1 0 0 1 2 1 0 0 1 2 3 2 1 0 0 1 2 3 4 3 2 1 00 1 2 3 4 5 4 3 2 1 0 0 1 2 3 4 3 2 1 0 0 1 2 3 2 1 0 0 1 2 1 0 0 1 0 0Your task is to determine the way the handkerchief will look like by the given n,256 megabytes,Print a picture for the given n You should strictly observe the number of spaces before the first digit on each line Every two adjacent digits in the same line should be separated by exactly one space There should be no spaces after the last digit at the end of each line,['constructive algorithms'/ 'implementation'],2 seconds,B Present from Lena
118,The first line contains two space-separated integers n and k 2 n 104 2 k n which represent how many digits the number has and how many equal digits a beautiful number should have The second line consists of n digits It describes the old number of Vasya s car It is guaranteed that the number contains no spaces and only contains digits,C,A car number in Berland consists of exactly n digits A number is called beautiful if it has at least k equal digits Vasya wants to change the digits in his car s number so that the number became beautiful To replace one of n digits Vasya has to pay the sum of money equal to the absolute difference between the old digit and the new one Help Vasya find the minimum sum of money he should pay to make the number of his car beautiful You should also find the resulting beautiful number If there are several such numbers then print the lexicographically minimum one,256 megabytes,On the first line print the minimum sum of money Vasya needs to change the number On the second line print the car s new number If there are several solutions print the lexicographically minimum one,['brute force'/ 'greedy'/ 'sortings'/ 'strings'],2 seconds,C Fancy Number
118,The only line contains four space-separated integers n1 n2 k1 k2 1 n1 n2 100 1 k1 k2 10 which represent how many footmen and horsemen there are and the largest acceptable number of footmen and horsemen standing in succession correspondingly,D,Gaius Julius Caesar a famous general loved to line up his soldiers Overall the army had n1 footmen and n2 horsemen Caesar thought that an arrangement is not beautiful if somewhere in the line there are strictly more that k1 footmen standing successively one after another or there are strictly more than k2 horsemen standing successively one after another Find the number of beautiful arrangements of the soldiers Note that all n1 n2 warriors should be present at each arrangement All footmen are considered indistinguishable among themselves Similarly all horsemen are considered indistinguishable among themselves,256 megabytes,Print the number of beautiful arrangements of the army modulo 100000000 108 That is print the number of such ways to line up the soldiers that no more than k1 footmen stand successively and no more than k2 horsemen stand successively,['dp'],2 seconds,D Caesar s Legions
118,The first line contains two space-separated integers n and m 2 n 105 n - 1 m 3 105 which represent the number of junctions and the roads in the town correspondingly Then follow m lines each containing two numbers which describe the roads in the city Each road is determined by two integers ai and bi 1 ai bi n ai bi the numbers of junctions it connects It is guaranteed that one can get from any junction to any other one along the existing bidirectional roads Each road connects different junctions there is no more than one road between each pair of junctions,E,Bertown has n junctions and m bidirectional roads We know that one can get from any junction to any other one by the existing roads As there were more and more cars in the city traffic jams started to pose real problems To deal with them the government decided to make the traffic one-directional on all the roads thus easing down the traffic Your task is to determine whether there is a way to make the traffic one-directional so that there still is the possibility to get from any junction to any other one If the answer is positive you should also find one of the possible ways to orient the roads,256 megabytes,If there s no solution print the single number 0 Otherwise print m lines each containing two integers pi and qi each road s orientation That is the traffic flow will move along a one-directional road from junction pi to junction qi You can print the roads in any order If there are several solutions to that problem print any of them,['dfs and similar'/ 'graphs'],5 seconds,E Bertown roads
119,The only string contains space-separated integers a b and n 1 a b n 100 the fixed numbers Simon and Antisimon have received correspondingly and the initial number of stones in the pile,A,Simon and Antisimon play a game Initially each player receives one fixed positive integer that doesn t change throughout the game Simon receives number a and Antisimon receives number b They also have a heap of n stones The players take turns to make a move and Simon starts During a move a player should take from the heap the number of stones equal to the greatest common divisor of the fixed number he has received and the number of stones left in the heap A player loses when he cannot take the required number of stones i e the heap has strictly less stones left than one needs to take Your task is to determine by the given a b and n who wins the game,256 megabytes,If Simon wins print 0 without the quotes otherwise print 1 without the quotes,['implementation'],2 seconds,A Epic Game
119,The first line contains two integers n and k 1 k n 100 the number of theorems and the number of cards correspondingly The second line contains n integers ai 0 ai 100 the i-th number 1 i n corresponds to Vasya s proficiency in the i-th theorem The third line contains number q 0 q 100 the number of people that have taken the exam before Vasya Each of the following q lines contains the description of a student s card integers from 1 to n inclusive They are the numbers of theorems included in the card in the order in which they are enumerated in the input data The numbers are given in an arbitrary order It is guaranteed that the given cards are valid that is that all theorems in one card are different and that different people get cards that either don t contain the same theorems or coincide up to the theorems permutation,B,Vasya is about to take his first university exam in about several minutes And it s not just some ordinary exam it s on mathematical analysis Of course right now Vasya can only think of one thing what the result of his talk with the examiner will be To prepare for the exam one has to study proofs of n theorems It is known that there will be k examination cards on the exam and each card contains distinct theorems Besides no theorem is mentioned in more than one card that is theorems won t be mentioned in any card During the exam several students may get the same card We do not know the exact way theorems are distributed by cards however the students that took the exam before Vasya told him what theorems their cards contained Vasya evaluates his level of proficiency in the i-th theorem by some number ai The level of proficiency in some card is the average of the levels of proficiency in the theorems that are included in the card Now Vasya wants to know the minimally and maximally possible levels of his proficiency in the card he gets on the exam Vasya wants to determine it by the data he has collected from other students Unfortunately Vasya has no time left to do the math and he asked you to help him,256 megabytes,Print two real numbers representing Vasya s minimum and maximum proficiency in the card he will get on the exam The absolute or relative error should not exceed 10 - 6,['constructive algorithms'/ 'implementation'/ 'sortings'],2 seconds,B Before Exam
119,The first line contains three integers n m k 1 n m 50 1 k 100 which represent the number of days in an academic year the number of subjects and the k parameter correspondingly Each of the following m lines contains the description of a subject as three integers ai bi ci 1 ai bi 1016 bi - ai 100 1 ci 100 two limitations to the number of exercises on the i-th subject and the complexity of the i-th subject correspondingly Distinct subjects can have the same complexity The subjects are numbered with integers from 1 to m Please do not use the lld specificator to read or write 64-bit numbers in It is preferred to use the cin stream or the I64d specificator,C,Yet another education system reform has been carried out in Berland recently The innovations are as follows An academic year now consists of n days Each day pupils study exactly one of m subjects besides each subject is studied for no more than one day After the lessons of the i-th subject pupils get the home task that contains no less than ai and no more than bi exercises Besides each subject has a special attribute the complexity ci A school can make its own timetable considering the following conditions are satisfied the timetable should contain the subjects in the order of the complexity s strict increasing each day except for the first one the task should contain either k times more exercises or more by k compared to the previous day more formally let s call the number of home task exercises in the i-th day as xi then for each i 1 i n either xi k xi - 1 or xi k xi - 1 must be true the total number of exercises in all home tasks should be maximal possible All limitations are separately set for each school It turned out that in many cases ai and bi reach 1016 however as the Berland Minister of Education is famous for his love to half-measures the value of bi - ai doesn t exceed 100 That also happened in the Berland School 256 Nevertheless you as the school s principal still have to work out the timetable for the next academic year,256 megabytes,If no valid solution exists print the single word NO without the quotes Otherwise the first line should contain the word YES without the quotes and the next n lines should contain any timetable that satisfies all the conditions The i 1-th line should contain two positive integers the number of the subject to study on the i-th day and the number of home task exercises given for this subject The timetable should contain exactly n subjects,['dp'],1 second,C Education Reform
119,The first two input lines are non-empty strings a and b correspondingly Each string s length does not exceed 106 characters The strings can contain any characters with ASCII codes from 32 to 126 inclusive,D,Let s be a string whose length equals n Its characters are numbered from 0 to n - 1 i and j are integers 0 i j n Let s define function f as follows f s i j s i 1 j - 1 r s j n - 1 r s 0 i Here s p q is a substring of string s that starts in position p and ends in position q inclusive is the string concatenation operator r x is a string resulting from writing the characters of the x string in the reverse order If j i 1 then the substring s i 1 j - 1 is considered empty You are given two strings a and b Find such values of i and j that f a i j b Number i should be maximally possible If for this i there exists several valid values of j choose the minimal j,256 megabytes,Print two integers i j the answer to the problem If no solution exists print -1 -1 without the quotes,['hashing'/ 'strings'],2 seconds,D String Transformation
119,The first line contains two integers n and m 1 n 900 1 m 100 the number of energetic spheres and the number of levels in the game correspondingly Each of the following n lines contains three integers xi yi zi 0 xi yi zi 104 the coordinates of the center of the i-th sphere Assume that these points do not change their positions throughout the game Then follow m lines each containing three integers ai bi ci 0 ai bi ci 100 ai2 bi2 ci2 0 These numbers are the coefficients in the equation of plane Qi aix biy ciz 0 where the player is positioned at the beginning of the i-th level,E,In the year of 3000 travelling around parallel realities became a routine thing However one has to take into consideration that travelling like that is highly dangerous as you never know beforehand where you re gonna get Little Vasya for instance found himself in a gaming reality and now he has to successfully complete all levels of a very weird game to get back The gaming reality is a three-dimensional space where n points are given The game has m levels and at the beginning of the i-th level the player is positioned at some plane Qi that passes through the origin On each level Vasya has to use special robots to construct and activate n powerful energy spheres of the equal radius with centers at the given points The player chooses the radius of the spheres himself The player has to spend R units of money to construct spheres whose radius equals R consequently one can construct spheres whose radius equals zero for free Besides once for each level a player can choose any point in space and release a laser ray from there perpendicular to plane Qi this action costs nothing The ray can either be directed towards the plane or from the plane The spheres that share at least one point with the ray will be immediately activated The level is considered completed if the player has managed to activate all spheres Note that the centers of the spheres are the same for all m levels but the spheres do not remain the player should construct them anew on each new level Help Vasya find out what minimum sum of money will be enough to complete each level,256 megabytes,Print m numbers one per line the i-th line should contain the minimum sum of money needed to complete the i-th level The absolute or relative error should not exceed 10 - 6,['geometry'],2 seconds,E Alternative Reality
12,Input contains the matrix of three rows of three symbols each Symbol X means that the corresponding button was pressed and means that is was not pressed The matrix may contain no X also it may contain no,A,There is a very secret base in Potatoland where potato mash is made according to a special recipe The neighbours from Porridgia decided to seize this recipe and to sell it to Pilauland For this mission they have been preparing special agent Pearlo for many years When finally Pearlo learned all secrets of espionage he penetrated into the Potatoland territory and reached the secret base Now he is standing at the entrance but to get inside he need to pass combination lock Minute ago one of the workers entered the password on the terminal and opened the door The terminal is a square digital keyboard 3 3 with digits from 1 to 9 Pearlo knows that the password consists from distinct digits and is probably symmetric with respect to the central button of the terminal He has heat sensor which allowed him to detect the digits which the worker pressed Now he wants to check whether the password entered by the worker is symmetric with respect to the central button of the terminal This fact can Help Pearlo to reduce the number of different possible password combinations,256 megabytes,Print YES if the password is symmetric with respect to the central button of the terminal and NO otherwise,['implementation'],2 seconds,A Super Agent
12,The first line contains one integer n 0 n 109 without leading zeroes The second lines contains one integer m 0 m 109 Bob s answer possibly with leading zeroes,B,One cold winter evening Alice and her older brother Bob was sitting at home near the fireplace and giving each other interesting problems to solve When it was Alice s turn she told the number n to Bob and said Shuffle the digits in this number in order to obtain the smallest possible number without leading zeroes No problem said Bob and immediately gave her an answer Alice said a random number so she doesn t know whether Bob s answer is correct Help her to find this out because impatient brother is waiting for the verdict,256 megabytes,Print OK if Bob s answer is correct and WRONG ANSWER otherwise,['implementation'/ 'sortings'],2 seconds,B Correct Solution
12,The first line of the input contains two integer number n and m 1 n m 100 the number of price tags which is equal to the number of different kinds of fruits that Ashot sells and the number of items in Valera s list The second line contains n space-separated positive integer numbers Each of them doesn t exceed 100 and stands for the price of one fruit of some kind The following m lines contain names of the fruits from the list Each name is a non-empty string of small Latin letters which length doesn t exceed 32 It is guaranteed that the number of distinct fruits from the list is less of equal to n Also it is known that the seller has in stock all fruits that Valera wants to buy,C,The spring is coming and it means that a lot of fruits appear on the counters One sunny day little boy Valera decided to go shopping He made a list of m fruits he wanted to buy If Valera want to buy more than one fruit of some kind he includes it into the list several times When he came to the fruit stall of Ashot he saw that the seller hadn t distributed price tags to the goods but put all price tags on the counter Later Ashot will attach every price tag to some kind of fruits and Valera will be able to count the total price of all fruits from his list But Valera wants to know now what can be the smallest total price in case of the most lucky for him distribution of price tags and the largest total price in case of the most unlucky for him distribution of price tags,256 megabytes,Print two numbers a and b a b the minimum and the maximum possible sum which Valera may need to buy all fruits from his list,['implementation'/ 'sortings'],1 second,C Fruits
12,The first line contains one integer N 1 N 500000 The second line contains N integer numbers Bi separated by single spaces The third and the fourth lines contain sequences Ii and Ri in the same format It is guaranteed that 0 Bi Ii Ri 109,D,N ladies attend the ball in the King s palace Every lady can be described with three values beauty intellect and richness King s Master of Ceremonies knows that ladies are very special creatures If some lady understands that there is other lady at the ball which is more beautiful smarter and more rich she can jump out of the window He knows values of all ladies and wants to find out how many probable self-murderers will be on the ball Lets denote beauty of the i-th lady by Bi her intellect by Ii and her richness by Ri Then i-th lady is a probable self-murderer if there is some j-th lady that Bi Bj Ii Ij Ri Rj Find the number of probable self-murderers,256 megabytes,Output the answer to the problem,['data structures'/ 'sortings'],2 seconds,D Ball
